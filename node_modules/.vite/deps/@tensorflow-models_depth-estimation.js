import {
  Tensor,
  add,
  argMax,
  backend,
  browser_exports,
  cast,
  clipByValue,
  dist_exports,
  div,
  engine,
  equal,
  expandDims,
  getBackend,
  greater,
  image,
  loadGraphModel,
  matMul,
  mirrorPad,
  mul,
  oneHot,
  pad,
  pad3d,
  range,
  reshape,
  round,
  scalar,
  sigmoid,
  slice,
  squeeze,
  sub,
  tensor,
  tensor2d,
  tidy,
  tile,
  util_exports
} from "./chunk-2WWJLBCC.js";
import {
  __commonJS,
  __toESM
} from "./chunk-G3PMV62Z.js";

// node_modules/@mediapipe/selfie_segmentation/selfie_segmentation.js
var require_selfie_segmentation = __commonJS({
  "node_modules/@mediapipe/selfie_segmentation/selfie_segmentation.js"(exports) {
    (function() {
      "use strict";
      var x;
      function aa(a2) {
        var b = 0;
        return function() {
          return b < a2.length ? { done: false, value: a2[b++] } : { done: true };
        };
      }
      var ba = "function" == typeof Object.defineProperties ? Object.defineProperty : function(a2, b, c2) {
        if (a2 == Array.prototype || a2 == Object.prototype) return a2;
        a2[b] = c2.value;
        return a2;
      };
      function ca(a2) {
        a2 = ["object" == typeof globalThis && globalThis, a2, "object" == typeof window && window, "object" == typeof self && self, "object" == typeof global && global];
        for (var b = 0; b < a2.length; ++b) {
          var c2 = a2[b];
          if (c2 && c2.Math == Math) return c2;
        }
        throw Error("Cannot find global object");
      }
      var y = ca(this);
      function z2(a2, b) {
        if (b) a: {
          var c2 = y;
          a2 = a2.split(".");
          for (var d2 = 0; d2 < a2.length - 1; d2++) {
            var e = a2[d2];
            if (!(e in c2)) break a;
            c2 = c2[e];
          }
          a2 = a2[a2.length - 1];
          d2 = c2[a2];
          b = b(d2);
          b != d2 && null != b && ba(c2, a2, { configurable: true, writable: true, value: b });
        }
      }
      z2("Symbol", function(a2) {
        function b(g2) {
          if (this instanceof b) throw new TypeError("Symbol is not a constructor");
          return new c2(d2 + (g2 || "") + "_" + e++, g2);
        }
        function c2(g2, f2) {
          this.h = g2;
          ba(this, "description", { configurable: true, writable: true, value: f2 });
        }
        if (a2) return a2;
        c2.prototype.toString = function() {
          return this.h;
        };
        var d2 = "jscomp_symbol_" + (1e9 * Math.random() >>> 0) + "_", e = 0;
        return b;
      });
      z2("Symbol.iterator", function(a2) {
        if (a2) return a2;
        a2 = Symbol("Symbol.iterator");
        for (var b = "Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "), c2 = 0; c2 < b.length; c2++) {
          var d2 = y[b[c2]];
          "function" === typeof d2 && "function" != typeof d2.prototype[a2] && ba(d2.prototype, a2, { configurable: true, writable: true, value: function() {
            return da(aa(this));
          } });
        }
        return a2;
      });
      function da(a2) {
        a2 = { next: a2 };
        a2[Symbol.iterator] = function() {
          return this;
        };
        return a2;
      }
      function A2(a2) {
        var b = "undefined" != typeof Symbol && Symbol.iterator && a2[Symbol.iterator];
        return b ? b.call(a2) : { next: aa(a2) };
      }
      function ea(a2) {
        if (!(a2 instanceof Array)) {
          a2 = A2(a2);
          for (var b, c2 = []; !(b = a2.next()).done; ) c2.push(b.value);
          a2 = c2;
        }
        return a2;
      }
      var fa = "function" == typeof Object.assign ? Object.assign : function(a2, b) {
        for (var c2 = 1; c2 < arguments.length; c2++) {
          var d2 = arguments[c2];
          if (d2) for (var e in d2) Object.prototype.hasOwnProperty.call(d2, e) && (a2[e] = d2[e]);
        }
        return a2;
      };
      z2("Object.assign", function(a2) {
        return a2 || fa;
      });
      var ha = "function" == typeof Object.create ? Object.create : function(a2) {
        function b() {
        }
        b.prototype = a2;
        return new b();
      }, ia;
      if ("function" == typeof Object.setPrototypeOf) ia = Object.setPrototypeOf;
      else {
        var ja;
        a: {
          var ka = { a: true }, la = {};
          try {
            la.__proto__ = ka;
            ja = la.a;
            break a;
          } catch (a2) {
          }
          ja = false;
        }
        ia = ja ? function(a2, b) {
          a2.__proto__ = b;
          if (a2.__proto__ !== b) throw new TypeError(a2 + " is not extensible");
          return a2;
        } : null;
      }
      var ma = ia;
      function na(a2, b) {
        a2.prototype = ha(b.prototype);
        a2.prototype.constructor = a2;
        if (ma) ma(a2, b);
        else for (var c2 in b) if ("prototype" != c2) if (Object.defineProperties) {
          var d2 = Object.getOwnPropertyDescriptor(b, c2);
          d2 && Object.defineProperty(a2, c2, d2);
        } else a2[c2] = b[c2];
        a2.za = b.prototype;
      }
      function oa() {
        this.m = false;
        this.j = null;
        this.i = void 0;
        this.h = 1;
        this.v = this.s = 0;
        this.l = null;
      }
      function pa(a2) {
        if (a2.m) throw new TypeError("Generator is already running");
        a2.m = true;
      }
      oa.prototype.u = function(a2) {
        this.i = a2;
      };
      function qa(a2, b) {
        a2.l = { ma: b, na: true };
        a2.h = a2.s || a2.v;
      }
      oa.prototype.return = function(a2) {
        this.l = { return: a2 };
        this.h = this.v;
      };
      function D2(a2, b, c2) {
        a2.h = c2;
        return { value: b };
      }
      function ra(a2) {
        this.h = new oa();
        this.i = a2;
      }
      function sa(a2, b) {
        pa(a2.h);
        var c2 = a2.h.j;
        if (c2) return ta(a2, "return" in c2 ? c2["return"] : function(d2) {
          return { value: d2, done: true };
        }, b, a2.h.return);
        a2.h.return(b);
        return ua(a2);
      }
      function ta(a2, b, c2, d2) {
        try {
          var e = b.call(a2.h.j, c2);
          if (!(e instanceof Object)) throw new TypeError("Iterator result " + e + " is not an object");
          if (!e.done) return a2.h.m = false, e;
          var g2 = e.value;
        } catch (f2) {
          return a2.h.j = null, qa(a2.h, f2), ua(a2);
        }
        a2.h.j = null;
        d2.call(a2.h, g2);
        return ua(a2);
      }
      function ua(a2) {
        for (; a2.h.h; ) try {
          var b = a2.i(a2.h);
          if (b) return a2.h.m = false, { value: b.value, done: false };
        } catch (c2) {
          a2.h.i = void 0, qa(a2.h, c2);
        }
        a2.h.m = false;
        if (a2.h.l) {
          b = a2.h.l;
          a2.h.l = null;
          if (b.na) throw b.ma;
          return { value: b.return, done: true };
        }
        return { value: void 0, done: true };
      }
      function va(a2) {
        this.next = function(b) {
          pa(a2.h);
          a2.h.j ? b = ta(a2, a2.h.j.next, b, a2.h.u) : (a2.h.u(b), b = ua(a2));
          return b;
        };
        this.throw = function(b) {
          pa(a2.h);
          a2.h.j ? b = ta(a2, a2.h.j["throw"], b, a2.h.u) : (qa(a2.h, b), b = ua(a2));
          return b;
        };
        this.return = function(b) {
          return sa(a2, b);
        };
        this[Symbol.iterator] = function() {
          return this;
        };
      }
      function wa(a2) {
        function b(d2) {
          return a2.next(d2);
        }
        function c2(d2) {
          return a2.throw(d2);
        }
        return new Promise(function(d2, e) {
          function g2(f2) {
            f2.done ? d2(f2.value) : Promise.resolve(f2.value).then(b, c2).then(g2, e);
          }
          g2(a2.next());
        });
      }
      function E(a2) {
        return wa(new va(new ra(a2)));
      }
      z2("Promise", function(a2) {
        function b(f2) {
          this.i = 0;
          this.j = void 0;
          this.h = [];
          this.u = false;
          var h2 = this.l();
          try {
            f2(h2.resolve, h2.reject);
          } catch (k) {
            h2.reject(k);
          }
        }
        function c2() {
          this.h = null;
        }
        function d2(f2) {
          return f2 instanceof b ? f2 : new b(function(h2) {
            h2(f2);
          });
        }
        if (a2) return a2;
        c2.prototype.i = function(f2) {
          if (null == this.h) {
            this.h = [];
            var h2 = this;
            this.j(function() {
              h2.m();
            });
          }
          this.h.push(f2);
        };
        var e = y.setTimeout;
        c2.prototype.j = function(f2) {
          e(f2, 0);
        };
        c2.prototype.m = function() {
          for (; this.h && this.h.length; ) {
            var f2 = this.h;
            this.h = [];
            for (var h2 = 0; h2 < f2.length; ++h2) {
              var k = f2[h2];
              f2[h2] = null;
              try {
                k();
              } catch (l2) {
                this.l(l2);
              }
            }
          }
          this.h = null;
        };
        c2.prototype.l = function(f2) {
          this.j(function() {
            throw f2;
          });
        };
        b.prototype.l = function() {
          function f2(l2) {
            return function(m2) {
              k || (k = true, l2.call(h2, m2));
            };
          }
          var h2 = this, k = false;
          return { resolve: f2(this.I), reject: f2(this.m) };
        };
        b.prototype.I = function(f2) {
          if (f2 === this) this.m(new TypeError("A Promise cannot resolve to itself"));
          else if (f2 instanceof b) this.L(f2);
          else {
            a: switch (typeof f2) {
              case "object":
                var h2 = null != f2;
                break a;
              case "function":
                h2 = true;
                break a;
              default:
                h2 = false;
            }
            h2 ? this.F(f2) : this.s(f2);
          }
        };
        b.prototype.F = function(f2) {
          var h2 = void 0;
          try {
            h2 = f2.then;
          } catch (k) {
            this.m(k);
            return;
          }
          "function" == typeof h2 ? this.M(h2, f2) : this.s(f2);
        };
        b.prototype.m = function(f2) {
          this.v(2, f2);
        };
        b.prototype.s = function(f2) {
          this.v(1, f2);
        };
        b.prototype.v = function(f2, h2) {
          if (0 != this.i) throw Error("Cannot settle(" + f2 + ", " + h2 + "): Promise already settled in state" + this.i);
          this.i = f2;
          this.j = h2;
          2 === this.i && this.K();
          this.H();
        };
        b.prototype.K = function() {
          var f2 = this;
          e(function() {
            if (f2.D()) {
              var h2 = y.console;
              "undefined" !== typeof h2 && h2.error(f2.j);
            }
          }, 1);
        };
        b.prototype.D = function() {
          if (this.u) return false;
          var f2 = y.CustomEvent, h2 = y.Event, k = y.dispatchEvent;
          if ("undefined" === typeof k) return true;
          "function" === typeof f2 ? f2 = new f2("unhandledrejection", { cancelable: true }) : "function" === typeof h2 ? f2 = new h2("unhandledrejection", { cancelable: true }) : (f2 = y.document.createEvent("CustomEvent"), f2.initCustomEvent("unhandledrejection", false, true, f2));
          f2.promise = this;
          f2.reason = this.j;
          return k(f2);
        };
        b.prototype.H = function() {
          if (null != this.h) {
            for (var f2 = 0; f2 < this.h.length; ++f2) g2.i(this.h[f2]);
            this.h = null;
          }
        };
        var g2 = new c2();
        b.prototype.L = function(f2) {
          var h2 = this.l();
          f2.T(h2.resolve, h2.reject);
        };
        b.prototype.M = function(f2, h2) {
          var k = this.l();
          try {
            f2.call(h2, k.resolve, k.reject);
          } catch (l2) {
            k.reject(l2);
          }
        };
        b.prototype.then = function(f2, h2) {
          function k(p2, n) {
            return "function" == typeof p2 ? function(q2) {
              try {
                l2(p2(q2));
              } catch (t) {
                m2(t);
              }
            } : n;
          }
          var l2, m2, r2 = new b(function(p2, n) {
            l2 = p2;
            m2 = n;
          });
          this.T(k(f2, l2), k(h2, m2));
          return r2;
        };
        b.prototype.catch = function(f2) {
          return this.then(void 0, f2);
        };
        b.prototype.T = function(f2, h2) {
          function k() {
            switch (l2.i) {
              case 1:
                f2(l2.j);
                break;
              case 2:
                h2(l2.j);
                break;
              default:
                throw Error("Unexpected state: " + l2.i);
            }
          }
          var l2 = this;
          null == this.h ? g2.i(k) : this.h.push(k);
          this.u = true;
        };
        b.resolve = d2;
        b.reject = function(f2) {
          return new b(function(h2, k) {
            k(f2);
          });
        };
        b.race = function(f2) {
          return new b(function(h2, k) {
            for (var l2 = A2(f2), m2 = l2.next(); !m2.done; m2 = l2.next()) d2(m2.value).T(h2, k);
          });
        };
        b.all = function(f2) {
          var h2 = A2(f2), k = h2.next();
          return k.done ? d2([]) : new b(function(l2, m2) {
            function r2(q2) {
              return function(t) {
                p2[q2] = t;
                n--;
                0 == n && l2(p2);
              };
            }
            var p2 = [], n = 0;
            do
              p2.push(void 0), n++, d2(k.value).T(r2(p2.length - 1), m2), k = h2.next();
            while (!k.done);
          });
        };
        return b;
      });
      function xa(a2, b) {
        a2 instanceof String && (a2 += "");
        var c2 = 0, d2 = false, e = { next: function() {
          if (!d2 && c2 < a2.length) {
            var g2 = c2++;
            return { value: b(g2, a2[g2]), done: false };
          }
          d2 = true;
          return { done: true, value: void 0 };
        } };
        e[Symbol.iterator] = function() {
          return e;
        };
        return e;
      }
      z2("Array.prototype.keys", function(a2) {
        return a2 ? a2 : function() {
          return xa(this, function(b) {
            return b;
          });
        };
      });
      z2("Array.prototype.fill", function(a2) {
        return a2 ? a2 : function(b, c2, d2) {
          var e = this.length || 0;
          0 > c2 && (c2 = Math.max(0, e + c2));
          if (null == d2 || d2 > e) d2 = e;
          d2 = Number(d2);
          0 > d2 && (d2 = Math.max(0, e + d2));
          for (c2 = Number(c2 || 0); c2 < d2; c2++) this[c2] = b;
          return this;
        };
      });
      function F2(a2) {
        return a2 ? a2 : Array.prototype.fill;
      }
      z2("Int8Array.prototype.fill", F2);
      z2("Uint8Array.prototype.fill", F2);
      z2("Uint8ClampedArray.prototype.fill", F2);
      z2("Int16Array.prototype.fill", F2);
      z2("Uint16Array.prototype.fill", F2);
      z2("Int32Array.prototype.fill", F2);
      z2("Uint32Array.prototype.fill", F2);
      z2("Float32Array.prototype.fill", F2);
      z2("Float64Array.prototype.fill", F2);
      z2("Object.is", function(a2) {
        return a2 ? a2 : function(b, c2) {
          return b === c2 ? 0 !== b || 1 / b === 1 / c2 : b !== b && c2 !== c2;
        };
      });
      z2("Array.prototype.includes", function(a2) {
        return a2 ? a2 : function(b, c2) {
          var d2 = this;
          d2 instanceof String && (d2 = String(d2));
          var e = d2.length;
          c2 = c2 || 0;
          for (0 > c2 && (c2 = Math.max(c2 + e, 0)); c2 < e; c2++) {
            var g2 = d2[c2];
            if (g2 === b || Object.is(g2, b)) return true;
          }
          return false;
        };
      });
      z2("String.prototype.includes", function(a2) {
        return a2 ? a2 : function(b, c2) {
          if (null == this) throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");
          if (b instanceof RegExp) throw new TypeError("First argument to String.prototype.includes must not be a regular expression");
          return -1 !== this.indexOf(b, c2 || 0);
        };
      });
      var ya = this || self;
      function Aa(a2, b) {
        a2 = a2.split(".");
        var c2 = ya;
        a2[0] in c2 || "undefined" == typeof c2.execScript || c2.execScript("var " + a2[0]);
        for (var d2; a2.length && (d2 = a2.shift()); ) a2.length || void 0 === b ? c2[d2] && c2[d2] !== Object.prototype[d2] ? c2 = c2[d2] : c2 = c2[d2] = {} : c2[d2] = b;
      }
      ;
      function Ba(a2) {
        var b;
        a: {
          if (b = ya.navigator) {
            if (b = b.userAgent) break a;
          }
          b = "";
        }
        return -1 != b.indexOf(a2);
      }
      ;
      var Ca = Array.prototype.map ? function(a2, b) {
        return Array.prototype.map.call(a2, b, void 0);
      } : function(a2, b) {
        for (var c2 = a2.length, d2 = Array(c2), e = "string" === typeof a2 ? a2.split("") : a2, g2 = 0; g2 < c2; g2++) g2 in e && (d2[g2] = b.call(void 0, e[g2], g2, a2));
        return d2;
      };
      var Da = {}, Ea = null;
      function Fa(a2) {
        var b = a2.length, c2 = 3 * b / 4;
        c2 % 3 ? c2 = Math.floor(c2) : -1 != "=.".indexOf(a2[b - 1]) && (c2 = -1 != "=.".indexOf(a2[b - 2]) ? c2 - 2 : c2 - 1);
        var d2 = new Uint8Array(c2), e = 0;
        Ga(a2, function(g2) {
          d2[e++] = g2;
        });
        return e !== c2 ? d2.subarray(0, e) : d2;
      }
      function Ga(a2, b) {
        function c2(k) {
          for (; d2 < a2.length; ) {
            var l2 = a2.charAt(d2++), m2 = Ea[l2];
            if (null != m2) return m2;
            if (!/^[\s\xa0]*$/.test(l2)) throw Error("Unknown base64 encoding at char: " + l2);
          }
          return k;
        }
        Ha();
        for (var d2 = 0; ; ) {
          var e = c2(-1), g2 = c2(0), f2 = c2(64), h2 = c2(64);
          if (64 === h2 && -1 === e) break;
          b(e << 2 | g2 >> 4);
          64 != f2 && (b(g2 << 4 & 240 | f2 >> 2), 64 != h2 && b(f2 << 6 & 192 | h2));
        }
      }
      function Ha() {
        if (!Ea) {
          Ea = {};
          for (var a2 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""), b = ["+/=", "+/", "-_=", "-_.", "-_"], c2 = 0; 5 > c2; c2++) {
            var d2 = a2.concat(b[c2].split(""));
            Da[c2] = d2;
            for (var e = 0; e < d2.length; e++) {
              var g2 = d2[e];
              void 0 === Ea[g2] && (Ea[g2] = e);
            }
          }
        }
      }
      ;
      var Ia = "undefined" !== typeof Uint8Array, Ja = !(Ba("Trident") || Ba("MSIE")) && "function" === typeof ya.btoa;
      function Ka(a2) {
        if (!Ja) {
          var b;
          void 0 === b && (b = 0);
          Ha();
          b = Da[b];
          for (var c2 = Array(Math.floor(a2.length / 3)), d2 = b[64] || "", e = 0, g2 = 0; e < a2.length - 2; e += 3) {
            var f2 = a2[e], h2 = a2[e + 1], k = a2[e + 2], l2 = b[f2 >> 2];
            f2 = b[(f2 & 3) << 4 | h2 >> 4];
            h2 = b[(h2 & 15) << 2 | k >> 6];
            k = b[k & 63];
            c2[g2++] = l2 + f2 + h2 + k;
          }
          l2 = 0;
          k = d2;
          switch (a2.length - e) {
            case 2:
              l2 = a2[e + 1], k = b[(l2 & 15) << 2] || d2;
            case 1:
              a2 = a2[e], c2[g2] = b[a2 >> 2] + b[(a2 & 3) << 4 | l2 >> 4] + k + d2;
          }
          return c2.join("");
        }
        for (b = ""; 10240 < a2.length; ) b += String.fromCharCode.apply(null, a2.subarray(0, 10240)), a2 = a2.subarray(10240);
        b += String.fromCharCode.apply(
          null,
          a2
        );
        return btoa(b);
      }
      var La = RegExp("[-_.]", "g");
      function Ma(a2) {
        switch (a2) {
          case "-":
            return "+";
          case "_":
            return "/";
          case ".":
            return "=";
          default:
            return "";
        }
      }
      function Na(a2) {
        if (!Ja) return Fa(a2);
        La.test(a2) && (a2 = a2.replace(La, Ma));
        a2 = atob(a2);
        for (var b = new Uint8Array(a2.length), c2 = 0; c2 < a2.length; c2++) b[c2] = a2.charCodeAt(c2);
        return b;
      }
      var Oa;
      function Pa() {
        return Oa || (Oa = new Uint8Array(0));
      }
      var Qa = {};
      var Ra = "function" === typeof Uint8Array.prototype.slice, G2 = 0, H = 0;
      function Sa(a2) {
        var b = 0 > a2;
        a2 = Math.abs(a2);
        var c2 = a2 >>> 0;
        a2 = Math.floor((a2 - c2) / 4294967296);
        b && (c2 = A2(Ta(c2, a2)), b = c2.next().value, a2 = c2.next().value, c2 = b);
        G2 = c2 >>> 0;
        H = a2 >>> 0;
      }
      var Ua = "function" === typeof BigInt;
      function Ta(a2, b) {
        b = ~b;
        a2 ? a2 = ~a2 + 1 : b += 1;
        return [a2, b];
      }
      ;
      function Va(a2, b) {
        this.i = a2 >>> 0;
        this.h = b >>> 0;
      }
      function Wa(a2) {
        if (!a2) return Xa || (Xa = new Va(0, 0));
        if (!/^-?\d+$/.test(a2)) return null;
        if (16 > a2.length) Sa(Number(a2));
        else if (Ua) a2 = BigInt(a2), G2 = Number(a2 & BigInt(4294967295)) >>> 0, H = Number(a2 >> BigInt(32) & BigInt(4294967295));
        else {
          var b = +("-" === a2[0]);
          H = G2 = 0;
          for (var c2 = a2.length, d2 = b, e = (c2 - b) % 6 + b; e <= c2; d2 = e, e += 6) d2 = Number(a2.slice(d2, e)), H *= 1e6, G2 = 1e6 * G2 + d2, 4294967296 <= G2 && (H += G2 / 4294967296 | 0, G2 %= 4294967296);
          b && (b = A2(Ta(G2, H)), a2 = b.next().value, b = b.next().value, G2 = a2, H = b);
        }
        return new Va(G2, H);
      }
      var Xa;
      function Ya(a2, b) {
        return Error("Invalid wire type: " + a2 + " (at position " + b + ")");
      }
      function Za() {
        return Error("Failed to read varint, encoding is invalid.");
      }
      function $a(a2, b) {
        return Error("Tried to read past the end of the data " + b + " > " + a2);
      }
      ;
      function K() {
        throw Error("Invalid UTF8");
      }
      function ab(a2, b) {
        b = String.fromCharCode.apply(null, b);
        return null == a2 ? b : a2 + b;
      }
      var bb = void 0, cb, db = "undefined" !== typeof TextDecoder, eb, fb = "undefined" !== typeof TextEncoder;
      var gb;
      function hb(a2) {
        if (a2 !== Qa) throw Error("illegal external caller");
      }
      function ib(a2, b) {
        hb(b);
        this.V = a2;
        if (null != a2 && 0 === a2.length) throw Error("ByteString should be constructed with non-empty values");
      }
      function jb() {
        return gb || (gb = new ib(null, Qa));
      }
      function kb(a2) {
        hb(Qa);
        var b = a2.V;
        b = null == b || Ia && null != b && b instanceof Uint8Array ? b : "string" === typeof b ? Na(b) : null;
        return null == b ? b : a2.V = b;
      }
      ;
      function lb(a2) {
        if ("string" === typeof a2) return { buffer: Na(a2), C: false };
        if (Array.isArray(a2)) return { buffer: new Uint8Array(a2), C: false };
        if (a2.constructor === Uint8Array) return { buffer: a2, C: false };
        if (a2.constructor === ArrayBuffer) return { buffer: new Uint8Array(a2), C: false };
        if (a2.constructor === ib) return { buffer: kb(a2) || Pa(), C: true };
        if (a2 instanceof Uint8Array) return { buffer: new Uint8Array(a2.buffer, a2.byteOffset, a2.byteLength), C: false };
        throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers");
      }
      ;
      function mb(a2, b) {
        this.i = null;
        this.m = false;
        this.h = this.j = this.l = 0;
        nb(this, a2, b);
      }
      function nb(a2, b, c2) {
        c2 = void 0 === c2 ? {} : c2;
        a2.S = void 0 === c2.S ? false : c2.S;
        b && (b = lb(b), a2.i = b.buffer, a2.m = b.C, a2.l = 0, a2.j = a2.i.length, a2.h = a2.l);
      }
      mb.prototype.reset = function() {
        this.h = this.l;
      };
      function L2(a2, b) {
        a2.h = b;
        if (b > a2.j) throw $a(a2.j, b);
      }
      function ob(a2) {
        var b = a2.i, c2 = a2.h, d2 = b[c2++], e = d2 & 127;
        if (d2 & 128 && (d2 = b[c2++], e |= (d2 & 127) << 7, d2 & 128 && (d2 = b[c2++], e |= (d2 & 127) << 14, d2 & 128 && (d2 = b[c2++], e |= (d2 & 127) << 21, d2 & 128 && (d2 = b[c2++], e |= d2 << 28, d2 & 128 && b[c2++] & 128 && b[c2++] & 128 && b[c2++] & 128 && b[c2++] & 128 && b[c2++] & 128))))) throw Za();
        L2(a2, c2);
        return e;
      }
      function pb(a2, b) {
        if (0 > b) throw Error("Tried to read a negative byte length: " + b);
        var c2 = a2.h, d2 = c2 + b;
        if (d2 > a2.j) throw $a(b, a2.j - c2);
        a2.h = d2;
        return c2;
      }
      var qb = [];
      function rb() {
        this.h = [];
      }
      rb.prototype.length = function() {
        return this.h.length;
      };
      rb.prototype.end = function() {
        var a2 = this.h;
        this.h = [];
        return a2;
      };
      function sb(a2, b, c2) {
        for (; 0 < c2 || 127 < b; ) a2.h.push(b & 127 | 128), b = (b >>> 7 | c2 << 25) >>> 0, c2 >>>= 7;
        a2.h.push(b);
      }
      function M(a2, b) {
        for (; 127 < b; ) a2.h.push(b & 127 | 128), b >>>= 7;
        a2.h.push(b);
      }
      ;
      function tb(a2, b) {
        if (qb.length) {
          var c2 = qb.pop();
          nb(c2, a2, b);
          a2 = c2;
        } else a2 = new mb(a2, b);
        this.h = a2;
        this.j = this.h.h;
        this.i = this.l = -1;
        this.setOptions(b);
      }
      tb.prototype.setOptions = function(a2) {
        a2 = void 0 === a2 ? {} : a2;
        this.ca = void 0 === a2.ca ? false : a2.ca;
      };
      tb.prototype.reset = function() {
        this.h.reset();
        this.j = this.h.h;
        this.i = this.l = -1;
      };
      function ub(a2) {
        var b = a2.h;
        if (b.h == b.j) return false;
        a2.j = a2.h.h;
        var c2 = ob(a2.h) >>> 0;
        b = c2 >>> 3;
        c2 &= 7;
        if (!(0 <= c2 && 5 >= c2)) throw Ya(c2, a2.j);
        if (1 > b) throw Error("Invalid field number: " + b + " (at position " + a2.j + ")");
        a2.l = b;
        a2.i = c2;
        return true;
      }
      function vb(a2) {
        switch (a2.i) {
          case 0:
            if (0 != a2.i) vb(a2);
            else a: {
              a2 = a2.h;
              for (var b = a2.h, c2 = b + 10, d2 = a2.i; b < c2; ) if (0 === (d2[b++] & 128)) {
                L2(a2, b);
                break a;
              }
              throw Za();
            }
            break;
          case 1:
            a2 = a2.h;
            L2(a2, a2.h + 8);
            break;
          case 2:
            2 != a2.i ? vb(a2) : (b = ob(a2.h) >>> 0, a2 = a2.h, L2(a2, a2.h + b));
            break;
          case 5:
            a2 = a2.h;
            L2(a2, a2.h + 4);
            break;
          case 3:
            b = a2.l;
            do {
              if (!ub(a2)) throw Error("Unmatched start-group tag: stream EOF");
              if (4 == a2.i) {
                if (a2.l != b) throw Error("Unmatched end-group tag");
                break;
              }
              vb(a2);
            } while (1);
            break;
          default:
            throw Ya(a2.i, a2.j);
        }
      }
      var wb = [];
      function xb() {
        this.j = [];
        this.i = 0;
        this.h = new rb();
      }
      function N2(a2, b) {
        0 !== b.length && (a2.j.push(b), a2.i += b.length);
      }
      function yb(a2, b) {
        if (b = b.R) {
          N2(a2, a2.h.end());
          for (var c2 = 0; c2 < b.length; c2++) N2(a2, kb(b[c2]) || Pa());
        }
      }
      ;
      var O = "function" === typeof Symbol && "symbol" === typeof Symbol() ? Symbol() : void 0;
      function P(a2, b) {
        if (O) return a2[O] |= b;
        if (void 0 !== a2.A) return a2.A |= b;
        Object.defineProperties(a2, { A: { value: b, configurable: true, writable: true, enumerable: false } });
        return b;
      }
      function zb(a2, b) {
        O ? a2[O] && (a2[O] &= ~b) : void 0 !== a2.A && (a2.A &= ~b);
      }
      function Q2(a2) {
        var b;
        O ? b = a2[O] : b = a2.A;
        return null == b ? 0 : b;
      }
      function R2(a2, b) {
        O ? a2[O] = b : void 0 !== a2.A ? a2.A = b : Object.defineProperties(a2, { A: { value: b, configurable: true, writable: true, enumerable: false } });
      }
      function Ab(a2) {
        P(a2, 1);
        return a2;
      }
      function Bb(a2, b) {
        R2(b, (a2 | 0) & -51);
      }
      function Cb(a2, b) {
        R2(b, (a2 | 18) & -41);
      }
      ;
      var Db = {};
      function Eb(a2) {
        return null !== a2 && "object" === typeof a2 && !Array.isArray(a2) && a2.constructor === Object;
      }
      var Fb, Gb = [];
      R2(Gb, 23);
      Fb = Object.freeze(Gb);
      function Hb(a2) {
        if (Q2(a2.o) & 2) throw Error("Cannot mutate an immutable Message");
      }
      function Ib(a2) {
        var b = a2.length;
        (b = b ? a2[b - 1] : void 0) && Eb(b) ? b.g = 1 : (b = {}, a2.push((b.g = 1, b)));
      }
      ;
      function Jb(a2) {
        var b = a2.i + a2.G;
        return a2.B || (a2.B = a2.o[b] = {});
      }
      function S(a2, b) {
        return -1 === b ? null : b >= a2.i ? a2.B ? a2.B[b] : void 0 : a2.o[b + a2.G];
      }
      function U(a2, b, c2, d2) {
        Hb(a2);
        Kb(a2, b, c2, d2);
      }
      function Kb(a2, b, c2, d2) {
        a2.j && (a2.j = void 0);
        b >= a2.i || d2 ? Jb(a2)[b] = c2 : (a2.o[b + a2.G] = c2, (a2 = a2.B) && b in a2 && delete a2[b]);
      }
      function Lb(a2, b, c2, d2) {
        var e = S(a2, b);
        Array.isArray(e) || (e = Fb);
        var g2 = Q2(e);
        g2 & 1 || Ab(e);
        if (d2) g2 & 2 || P(e, 2), c2 & 1 || Object.freeze(e);
        else {
          d2 = !(c2 & 2);
          var f2 = g2 & 2;
          c2 & 1 || !f2 ? d2 && g2 & 16 && !f2 && zb(e, 16) : (e = Ab(Array.prototype.slice.call(e)), Kb(a2, b, e));
        }
        return e;
      }
      function Mb(a2, b) {
        var c2 = S(a2, b);
        var d2 = null == c2 ? c2 : "number" === typeof c2 || "NaN" === c2 || "Infinity" === c2 || "-Infinity" === c2 ? Number(c2) : void 0;
        null != d2 && d2 !== c2 && Kb(a2, b, d2);
        return d2;
      }
      function Nb(a2, b, c2, d2, e) {
        a2.h || (a2.h = {});
        var g2 = a2.h[c2], f2 = Lb(a2, c2, 3, e);
        if (!g2) {
          var h2 = f2;
          g2 = [];
          var k = !!(Q2(a2.o) & 16);
          f2 = !!(Q2(h2) & 2);
          var l2 = h2;
          !e && f2 && (h2 = Array.prototype.slice.call(h2));
          for (var m2 = f2, r2 = 0; r2 < h2.length; r2++) {
            var p2 = h2[r2];
            var n = b, q2 = false;
            q2 = void 0 === q2 ? false : q2;
            p2 = Array.isArray(p2) ? new n(p2) : q2 ? new n() : void 0;
            if (void 0 !== p2) {
              n = p2.o;
              var t = q2 = Q2(n);
              f2 && (t |= 2);
              k && (t |= 16);
              t != q2 && R2(n, t);
              n = t;
              m2 = m2 || !!(2 & n);
              g2.push(p2);
            }
          }
          a2.h[c2] = g2;
          k = Q2(h2);
          b = k | 33;
          b = m2 ? b & -9 : b | 8;
          k != b && (m2 = h2, Object.isFrozen(m2) && (m2 = Array.prototype.slice.call(m2)), R2(m2, b), h2 = m2);
          l2 !== h2 && Kb(
            a2,
            c2,
            h2
          );
          (e || d2 && f2) && P(g2, 2);
          d2 && Object.freeze(g2);
          return g2;
        }
        e || (e = Object.isFrozen(g2), d2 && !e ? Object.freeze(g2) : !d2 && e && (g2 = Array.prototype.slice.call(g2), a2.h[c2] = g2));
        return g2;
      }
      function Ob(a2, b, c2) {
        var d2 = !!(Q2(a2.o) & 2);
        b = Nb(a2, b, c2, d2, d2);
        a2 = Lb(a2, c2, 3, d2);
        if (!(d2 || Q2(a2) & 8)) {
          for (d2 = 0; d2 < b.length; d2++) {
            c2 = b[d2];
            if (Q2(c2.o) & 2) {
              var e = Pb(c2, false);
              e.j = c2;
            } else e = c2;
            c2 !== e && (b[d2] = e, a2[d2] = e.o);
          }
          P(a2, 8);
        }
        return b;
      }
      function V2(a2, b, c2) {
        if (null != c2 && "number" !== typeof c2) throw Error("Value of float/double field must be a number|null|undefined, found " + typeof c2 + ": " + c2);
        U(a2, b, c2);
      }
      function Qb(a2, b, c2, d2, e) {
        Hb(a2);
        var g2 = Nb(a2, c2, b, false, false);
        c2 = null != d2 ? d2 : new c2();
        a2 = Lb(a2, b, 2, false);
        void 0 != e ? (g2.splice(e, 0, c2), a2.splice(e, 0, c2.o)) : (g2.push(c2), a2.push(c2.o));
        c2.C() && zb(a2, 8);
        return c2;
      }
      function Rb(a2, b) {
        return null == a2 ? b : a2;
      }
      function W2(a2, b, c2) {
        c2 = void 0 === c2 ? 0 : c2;
        return Rb(Mb(a2, b), c2);
      }
      ;
      var Sb;
      function Tb(a2) {
        switch (typeof a2) {
          case "number":
            return isFinite(a2) ? a2 : String(a2);
          case "object":
            if (a2) if (Array.isArray(a2)) {
              if (0 !== (Q2(a2) & 128)) return a2 = Array.prototype.slice.call(a2), Ib(a2), a2;
            } else {
              if (Ia && null != a2 && a2 instanceof Uint8Array) return Ka(a2);
              if (a2 instanceof ib) {
                var b = a2.V;
                return null == b ? "" : "string" === typeof b ? b : a2.V = Ka(b);
              }
            }
        }
        return a2;
      }
      ;
      function Ub(a2, b, c2, d2) {
        if (null != a2) {
          if (Array.isArray(a2)) a2 = Vb(a2, b, c2, void 0 !== d2);
          else if (Eb(a2)) {
            var e = {}, g2;
            for (g2 in a2) e[g2] = Ub(a2[g2], b, c2, d2);
            a2 = e;
          } else a2 = b(a2, d2);
          return a2;
        }
      }
      function Vb(a2, b, c2, d2) {
        var e = Q2(a2);
        d2 = d2 ? !!(e & 16) : void 0;
        a2 = Array.prototype.slice.call(a2);
        for (var g2 = 0; g2 < a2.length; g2++) a2[g2] = Ub(a2[g2], b, c2, d2);
        c2(e, a2);
        return a2;
      }
      function Wb(a2) {
        return a2.ja === Db ? a2.toJSON() : Tb(a2);
      }
      function Xb(a2, b) {
        a2 & 128 && Ib(b);
      }
      ;
      function Yb(a2, b, c2) {
        c2 = void 0 === c2 ? Cb : c2;
        if (null != a2) {
          if (Ia && a2 instanceof Uint8Array) return a2.length ? new ib(new Uint8Array(a2), Qa) : jb();
          if (Array.isArray(a2)) {
            var d2 = Q2(a2);
            if (d2 & 2) return a2;
            if (b && !(d2 & 32) && (d2 & 16 || 0 === d2)) return R2(a2, d2 | 2), a2;
            a2 = Vb(a2, Yb, d2 & 4 ? Cb : c2, true);
            b = Q2(a2);
            b & 4 && b & 2 && Object.freeze(a2);
            return a2;
          }
          return a2.ja === Db ? Zb(a2) : a2;
        }
      }
      function $b(a2, b, c2, d2, e, g2, f2) {
        if (a2 = a2.h && a2.h[c2]) {
          d2 = Q2(a2);
          d2 & 2 ? d2 = a2 : (g2 = Ca(a2, Zb), Cb(d2, g2), Object.freeze(g2), d2 = g2);
          Hb(b);
          f2 = null == d2 ? Fb : Ab([]);
          if (null != d2) {
            g2 = !!d2.length;
            for (a2 = 0; a2 < d2.length; a2++) {
              var h2 = d2[a2];
              g2 = g2 && !(Q2(h2.o) & 2);
              f2[a2] = h2.o;
            }
            g2 = (g2 ? 8 : 0) | 1;
            a2 = Q2(f2);
            (a2 & g2) !== g2 && (Object.isFrozen(f2) && (f2 = Array.prototype.slice.call(f2)), R2(f2, a2 | g2));
            b.h || (b.h = {});
            b.h[c2] = d2;
          } else b.h && (b.h[c2] = void 0);
          Kb(b, c2, f2, e);
        } else U(b, c2, Yb(d2, g2, f2), e);
      }
      function Zb(a2) {
        if (Q2(a2.o) & 2) return a2;
        a2 = Pb(a2, true);
        P(a2.o, 2);
        return a2;
      }
      function Pb(a2, b) {
        var c2 = a2.o, d2 = [];
        P(d2, 16);
        var e = a2.constructor.h;
        e && d2.push(e);
        e = a2.B;
        if (e) {
          d2.length = c2.length;
          d2.fill(void 0, d2.length, c2.length);
          var g2 = {};
          d2[d2.length - 1] = g2;
        }
        0 !== (Q2(c2) & 128) && Ib(d2);
        b = b || a2.C() ? Cb : Bb;
        g2 = a2.constructor;
        Sb = d2;
        d2 = new g2(d2);
        Sb = void 0;
        a2.R && (d2.R = a2.R.slice());
        g2 = !!(Q2(c2) & 16);
        for (var f2 = e ? c2.length - 1 : c2.length, h2 = 0; h2 < f2; h2++) $b(a2, d2, h2 - a2.G, c2[h2], false, g2, b);
        if (e) for (var k in e) $b(a2, d2, +k, e[k], true, g2, b);
        return d2;
      }
      ;
      function X2(a2, b, c2) {
        null == a2 && (a2 = Sb);
        Sb = void 0;
        var d2 = this.constructor.i || 0, e = 0 < d2, g2 = this.constructor.h, f2 = false;
        if (null == a2) {
          a2 = g2 ? [g2] : [];
          var h2 = 48;
          var k = true;
          e && (d2 = 0, h2 |= 128);
          R2(a2, h2);
        } else {
          if (!Array.isArray(a2)) throw Error();
          if (g2 && g2 !== a2[0]) throw Error();
          var l2 = h2 = P(a2, 0);
          if (k = 0 !== (16 & l2)) (f2 = 0 !== (32 & l2)) || (l2 |= 32);
          if (e) if (128 & l2) d2 = 0;
          else {
            if (0 < a2.length) {
              var m2 = a2[a2.length - 1];
              if (Eb(m2) && "g" in m2) {
                d2 = 0;
                l2 |= 128;
                delete m2.g;
                var r2 = true, p2;
                for (p2 in m2) {
                  r2 = false;
                  break;
                }
                r2 && a2.pop();
              }
            }
          }
          else if (128 & l2) throw Error();
          h2 !== l2 && R2(a2, l2);
        }
        this.G = (g2 ? 0 : -1) - d2;
        this.h = void 0;
        this.o = a2;
        a: {
          g2 = this.o.length;
          d2 = g2 - 1;
          if (g2 && (g2 = this.o[d2], Eb(g2))) {
            this.B = g2;
            this.i = d2 - this.G;
            break a;
          }
          void 0 !== b && -1 < b ? (this.i = Math.max(b, d2 + 1 - this.G), this.B = void 0) : this.i = Number.MAX_VALUE;
        }
        if (!e && this.B && "g" in this.B) throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');
        if (c2) {
          b = k && !f2 && true;
          e = this.i;
          var n;
          for (k = 0; k < c2.length; k++) f2 = c2[k], f2 < e ? (f2 += this.G, (d2 = a2[f2]) ? ac(d2, b) : a2[f2] = Fb) : (n || (n = Jb(this)), (d2 = n[f2]) ? ac(d2, b) : n[f2] = Fb);
        }
      }
      X2.prototype.toJSON = function() {
        return Vb(this.o, Wb, Xb);
      };
      X2.prototype.C = function() {
        return !!(Q2(this.o) & 2);
      };
      function ac(a2, b) {
        if (Array.isArray(a2)) {
          var c2 = Q2(a2), d2 = 1;
          !b || c2 & 2 || (d2 |= 16);
          (c2 & d2) !== d2 && R2(a2, c2 | d2);
        }
      }
      X2.prototype.ja = Db;
      X2.prototype.toString = function() {
        return this.o.toString();
      };
      function bc(a2, b, c2) {
        if (c2) {
          var d2 = {}, e;
          for (e in c2) {
            var g2 = c2[e], f2 = g2.ra;
            f2 || (d2.J = g2.xa || g2.oa.W, g2.ia ? (d2.aa = cc(g2.ia), f2 = /* @__PURE__ */ function(h2) {
              return function(k, l2, m2) {
                return h2.J(k, l2, m2, h2.aa);
              };
            }(d2)) : g2.ka ? (d2.Z = dc(g2.da.P, g2.ka), f2 = /* @__PURE__ */ function(h2) {
              return function(k, l2, m2) {
                return h2.J(k, l2, m2, h2.Z);
              };
            }(d2)) : f2 = d2.J, g2.ra = f2);
            f2(b, a2, g2.da);
            d2 = { J: d2.J, aa: d2.aa, Z: d2.Z };
          }
        }
        yb(b, a2);
      }
      var ec = Symbol();
      function fc(a2, b, c2) {
        return a2[ec] || (a2[ec] = function(d2, e) {
          return b(d2, e, c2);
        });
      }
      function gc(a2) {
        var b = a2[ec];
        if (!b) {
          var c2 = hc(a2);
          b = function(d2, e) {
            return ic(d2, e, c2);
          };
          a2[ec] = b;
        }
        return b;
      }
      function jc(a2) {
        var b = a2.ia;
        if (b) return gc(b);
        if (b = a2.wa) return fc(a2.da.P, b, a2.ka);
      }
      function kc(a2) {
        var b = jc(a2), c2 = a2.da, d2 = a2.oa.U;
        return b ? function(e, g2) {
          return d2(e, g2, c2, b);
        } : function(e, g2) {
          return d2(e, g2, c2);
        };
      }
      function lc(a2, b) {
        var c2 = a2[b];
        "function" == typeof c2 && 0 === c2.length && (c2 = c2(), a2[b] = c2);
        return Array.isArray(c2) && (mc in c2 || nc in c2 || 0 < c2.length && "function" == typeof c2[0]) ? c2 : void 0;
      }
      function oc(a2, b, c2, d2, e, g2) {
        b.P = a2[0];
        var f2 = 1;
        if (a2.length > f2 && "number" !== typeof a2[f2]) {
          var h2 = a2[f2++];
          c2(b, h2);
        }
        for (; f2 < a2.length; ) {
          c2 = a2[f2++];
          for (var k = f2 + 1; k < a2.length && "number" !== typeof a2[k]; ) k++;
          h2 = a2[f2++];
          k -= f2;
          switch (k) {
            case 0:
              d2(b, c2, h2);
              break;
            case 1:
              (k = lc(a2, f2)) ? (f2++, e(b, c2, h2, k)) : d2(b, c2, h2, a2[f2++]);
              break;
            case 2:
              k = f2++;
              k = lc(a2, k);
              e(b, c2, h2, k, a2[f2++]);
              break;
            case 3:
              g2(b, c2, h2, a2[f2++], a2[f2++], a2[f2++]);
              break;
            case 4:
              g2(b, c2, h2, a2[f2++], a2[f2++], a2[f2++], a2[f2++]);
              break;
            default:
              throw Error("unexpected number of binary field arguments: " + k);
          }
        }
        return b;
      }
      var pc = Symbol();
      function cc(a2) {
        var b = a2[pc];
        if (!b) {
          var c2 = qc(a2);
          b = function(d2, e) {
            return rc(d2, e, c2);
          };
          a2[pc] = b;
        }
        return b;
      }
      function dc(a2, b) {
        var c2 = a2[pc];
        c2 || (c2 = function(d2, e) {
          return bc(d2, e, b);
        }, a2[pc] = c2);
        return c2;
      }
      var nc = Symbol();
      function sc(a2, b) {
        a2.push(b);
      }
      function tc(a2, b, c2) {
        a2.push(b, c2.W);
      }
      function uc(a2, b, c2, d2) {
        var e = cc(d2), g2 = qc(d2).P, f2 = c2.W;
        a2.push(b, function(h2, k, l2) {
          return f2(h2, k, l2, g2, e);
        });
      }
      function vc(a2, b, c2, d2, e, g2) {
        var f2 = dc(d2, g2), h2 = c2.W;
        a2.push(b, function(k, l2, m2) {
          return h2(k, l2, m2, d2, f2);
        });
      }
      function qc(a2) {
        var b = a2[nc];
        if (b) return b;
        b = oc(a2, a2[nc] = [], sc, tc, uc, vc);
        mc in a2 && nc in a2 && (a2.length = 0);
        return b;
      }
      var mc = Symbol();
      function wc(a2, b) {
        a2[0] = b;
      }
      function xc(a2, b, c2, d2) {
        var e = c2.U;
        a2[b] = d2 ? function(g2, f2, h2) {
          return e(g2, f2, h2, d2);
        } : e;
      }
      function yc(a2, b, c2, d2, e) {
        var g2 = c2.U, f2 = gc(d2), h2 = hc(d2).P;
        a2[b] = function(k, l2, m2) {
          return g2(k, l2, m2, h2, f2, e);
        };
      }
      function zc(a2, b, c2, d2, e, g2, f2) {
        var h2 = c2.U, k = fc(d2, e, g2);
        a2[b] = function(l2, m2, r2) {
          return h2(l2, m2, r2, d2, k, f2);
        };
      }
      function hc(a2) {
        var b = a2[mc];
        if (b) return b;
        b = oc(a2, a2[mc] = {}, wc, xc, yc, zc);
        mc in a2 && nc in a2 && (a2.length = 0);
        return b;
      }
      function ic(a2, b, c2) {
        for (; ub(b) && 4 != b.i; ) {
          var d2 = b.l, e = c2[d2];
          if (!e) {
            var g2 = c2[0];
            g2 && (g2 = g2[d2]) && (e = c2[d2] = kc(g2));
          }
          if (!e || !e(b, a2, d2)) {
            e = b;
            d2 = a2;
            g2 = e.j;
            vb(e);
            var f2 = e;
            if (!f2.ca) {
              e = f2.h.h - g2;
              f2.h.h = g2;
              f2 = f2.h;
              if (0 == e) e = jb();
              else {
                g2 = pb(f2, e);
                if (f2.S && f2.m) e = f2.i.subarray(g2, g2 + e);
                else {
                  f2 = f2.i;
                  var h2 = g2;
                  e = g2 + e;
                  e = h2 === e ? Pa() : Ra ? f2.slice(h2, e) : new Uint8Array(f2.subarray(h2, e));
                }
                e = 0 == e.length ? jb() : new ib(e, Qa);
              }
              (g2 = d2.R) ? g2.push(e) : d2.R = [e];
            }
          }
        }
        return a2;
      }
      function rc(a2, b, c2) {
        for (var d2 = c2.length, e = 1 == d2 % 2, g2 = e ? 1 : 0; g2 < d2; g2 += 2) (0, c2[g2 + 1])(b, a2, c2[g2]);
        bc(a2, b, e ? c2[0] : void 0);
      }
      function Ac(a2, b) {
        return { U: a2, W: b };
      }
      var Y2 = Ac(function(a2, b, c2) {
        if (5 !== a2.i) return false;
        a2 = a2.h;
        var d2 = a2.i, e = a2.h, g2 = d2[e];
        var f2 = d2[e + 1];
        var h2 = d2[e + 2];
        d2 = d2[e + 3];
        L2(a2, a2.h + 4);
        f2 = (g2 << 0 | f2 << 8 | h2 << 16 | d2 << 24) >>> 0;
        a2 = 2 * (f2 >> 31) + 1;
        g2 = f2 >>> 23 & 255;
        f2 &= 8388607;
        U(b, c2, 255 == g2 ? f2 ? NaN : Infinity * a2 : 0 == g2 ? a2 * Math.pow(2, -149) * f2 : a2 * Math.pow(2, g2 - 150) * (f2 + Math.pow(2, 23)));
        return true;
      }, function(a2, b, c2) {
        b = Mb(b, c2);
        if (null != b) {
          M(a2.h, 8 * c2 + 5);
          a2 = a2.h;
          var d2 = +b;
          0 === d2 ? 0 < 1 / d2 ? G2 = H = 0 : (H = 0, G2 = 2147483648) : isNaN(d2) ? (H = 0, G2 = 2147483647) : (d2 = (c2 = 0 > d2 ? -2147483648 : 0) ? -d2 : d2, 34028234663852886e22 < d2 ? (H = 0, G2 = (c2 | 2139095040) >>> 0) : 11754943508222875e-54 > d2 ? (d2 = Math.round(d2 / Math.pow(2, -149)), H = 0, G2 = (c2 | d2) >>> 0) : (b = Math.floor(Math.log(d2) / Math.LN2), d2 *= Math.pow(2, -b), d2 = Math.round(8388608 * d2), 16777216 <= d2 && ++b, H = 0, G2 = (c2 | b + 127 << 23 | d2 & 8388607) >>> 0));
          c2 = G2;
          a2.h.push(c2 >>> 0 & 255);
          a2.h.push(c2 >>> 8 & 255);
          a2.h.push(c2 >>> 16 & 255);
          a2.h.push(c2 >>> 24 & 255);
        }
      }), Bc = Ac(function(a2, b, c2) {
        if (0 !== a2.i) return false;
        var d2 = a2.h, e = 0, g2 = a2 = 0, f2 = d2.i, h2 = d2.h;
        do {
          var k = f2[h2++];
          e |= (k & 127) << g2;
          g2 += 7;
        } while (32 > g2 && k & 128);
        32 < g2 && (a2 |= (k & 127) >> 4);
        for (g2 = 3; 32 > g2 && k & 128; g2 += 7) k = f2[h2++], a2 |= (k & 127) << g2;
        L2(
          d2,
          h2
        );
        if (128 > k) {
          d2 = e >>> 0;
          k = a2 >>> 0;
          if (a2 = k & 2147483648) d2 = ~d2 + 1 >>> 0, k = ~k >>> 0, 0 == d2 && (k = k + 1 >>> 0);
          d2 = 4294967296 * k + (d2 >>> 0);
        } else throw Za();
        U(b, c2, a2 ? -d2 : d2);
        return true;
      }, function(a2, b, c2) {
        b = S(b, c2);
        null != b && ("string" === typeof b && Wa(b), null != b && (M(a2.h, 8 * c2), "number" === typeof b ? (a2 = a2.h, Sa(b), sb(a2, G2, H)) : (c2 = Wa(b), sb(a2.h, c2.i, c2.h))));
      }), Cc = Ac(function(a2, b, c2) {
        if (0 !== a2.i) return false;
        U(b, c2, ob(a2.h));
        return true;
      }, function(a2, b, c2) {
        b = S(b, c2);
        if (null != b && null != b) if (M(a2.h, 8 * c2), a2 = a2.h, c2 = b, 0 <= c2) M(a2, c2);
        else {
          for (b = 0; 9 > b; b++) a2.h.push(c2 & 127 | 128), c2 >>= 7;
          a2.h.push(1);
        }
      }), Dc = Ac(function(a2, b, c2) {
        if (2 !== a2.i) return false;
        var d2 = ob(a2.h) >>> 0;
        a2 = a2.h;
        var e = pb(a2, d2);
        a2 = a2.i;
        if (db) {
          var g2 = a2, f2;
          (f2 = cb) || (f2 = cb = new TextDecoder("utf-8", { fatal: true }));
          a2 = e + d2;
          g2 = 0 === e && a2 === g2.length ? g2 : g2.subarray(e, a2);
          try {
            var h2 = f2.decode(g2);
          } catch (r2) {
            if (void 0 === bb) {
              try {
                f2.decode(new Uint8Array([128]));
              } catch (p2) {
              }
              try {
                f2.decode(new Uint8Array([97])), bb = true;
              } catch (p2) {
                bb = false;
              }
            }
            !bb && (cb = void 0);
            throw r2;
          }
        } else {
          h2 = e;
          d2 = h2 + d2;
          e = [];
          for (var k = null, l2, m2; h2 < d2; ) l2 = a2[h2++], 128 > l2 ? e.push(l2) : 224 > l2 ? h2 >= d2 ? K() : (m2 = a2[h2++], 194 > l2 || 128 !== (m2 & 192) ? (h2--, K()) : e.push((l2 & 31) << 6 | m2 & 63)) : 240 > l2 ? h2 >= d2 - 1 ? K() : (m2 = a2[h2++], 128 !== (m2 & 192) || 224 === l2 && 160 > m2 || 237 === l2 && 160 <= m2 || 128 !== ((g2 = a2[h2++]) & 192) ? (h2--, K()) : e.push((l2 & 15) << 12 | (m2 & 63) << 6 | g2 & 63)) : 244 >= l2 ? h2 >= d2 - 2 ? K() : (m2 = a2[h2++], 128 !== (m2 & 192) || 0 !== (l2 << 28) + (m2 - 144) >> 30 || 128 !== ((g2 = a2[h2++]) & 192) || 128 !== ((f2 = a2[h2++]) & 192) ? (h2--, K()) : (l2 = (l2 & 7) << 18 | (m2 & 63) << 12 | (g2 & 63) << 6 | f2 & 63, l2 -= 65536, e.push((l2 >> 10 & 1023) + 55296, (l2 & 1023) + 56320))) : K(), 8192 <= e.length && (k = ab(k, e), e.length = 0);
          h2 = ab(k, e);
        }
        U(b, c2, h2);
        return true;
      }, function(a2, b, c2) {
        b = S(b, c2);
        if (null != b) {
          var d2 = false;
          d2 = void 0 === d2 ? false : d2;
          if (fb) {
            if (d2 && /(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(b)) throw Error("Found an unpaired surrogate");
            b = (eb || (eb = new TextEncoder())).encode(b);
          } else {
            for (var e = 0, g2 = new Uint8Array(3 * b.length), f2 = 0; f2 < b.length; f2++) {
              var h2 = b.charCodeAt(f2);
              if (128 > h2) g2[e++] = h2;
              else {
                if (2048 > h2) g2[e++] = h2 >> 6 | 192;
                else {
                  if (55296 <= h2 && 57343 >= h2) {
                    if (56319 >= h2 && f2 < b.length) {
                      var k = b.charCodeAt(++f2);
                      if (56320 <= k && 57343 >= k) {
                        h2 = 1024 * (h2 - 55296) + k - 56320 + 65536;
                        g2[e++] = h2 >> 18 | 240;
                        g2[e++] = h2 >> 12 & 63 | 128;
                        g2[e++] = h2 >> 6 & 63 | 128;
                        g2[e++] = h2 & 63 | 128;
                        continue;
                      } else f2--;
                    }
                    if (d2) throw Error("Found an unpaired surrogate");
                    h2 = 65533;
                  }
                  g2[e++] = h2 >> 12 | 224;
                  g2[e++] = h2 >> 6 & 63 | 128;
                }
                g2[e++] = h2 & 63 | 128;
              }
            }
            b = e === g2.length ? g2 : g2.subarray(0, e);
          }
          M(a2.h, 8 * c2 + 2);
          M(a2.h, b.length);
          N2(a2, a2.h.end());
          N2(a2, b);
        }
      }), Ec = Ac(function(a2, b, c2, d2, e) {
        if (2 !== a2.i) return false;
        b = Qb(b, c2, d2);
        c2 = a2.h.j;
        d2 = ob(a2.h) >>> 0;
        var g2 = a2.h.h + d2, f2 = g2 - c2;
        0 >= f2 && (a2.h.j = g2, e(b, a2, void 0, void 0, void 0), f2 = g2 - a2.h.h);
        if (f2) throw Error("Message parsing ended unexpectedly. Expected to read " + (d2 + " bytes, instead read " + (d2 - f2) + " bytes, either the data ended unexpectedly or the message misreported its own length"));
        a2.h.h = g2;
        a2.h.j = c2;
        return true;
      }, function(a2, b, c2, d2, e) {
        b = Ob(b, d2, c2);
        if (null != b) for (d2 = 0; d2 < b.length; d2++) {
          var g2 = a2;
          M(g2.h, 8 * c2 + 2);
          var f2 = g2.h.end();
          N2(g2, f2);
          f2.push(g2.i);
          g2 = f2;
          e(b[d2], a2);
          f2 = a2;
          var h2 = g2.pop();
          for (h2 = f2.i + f2.h.length() - h2; 127 < h2; ) g2.push(h2 & 127 | 128), h2 >>>= 7, f2.i++;
          g2.push(h2);
          f2.i++;
        }
      });
      function Fc(a2) {
        return function(b, c2) {
          a: {
            if (wb.length) {
              var d2 = wb.pop();
              d2.setOptions(c2);
              nb(d2.h, b, c2);
              b = d2;
            } else b = new tb(b, c2);
            try {
              var e = hc(a2);
              var g2 = ic(new e.P(), b, e);
              break a;
            } finally {
              e = b.h, e.i = null, e.m = false, e.l = 0, e.j = 0, e.h = 0, e.S = false, b.l = -1, b.i = -1, 100 > wb.length && wb.push(b);
            }
            g2 = void 0;
          }
          return g2;
        };
      }
      function Gc(a2) {
        return function() {
          var b = new xb();
          rc(this, b, qc(a2));
          N2(b, b.h.end());
          for (var c2 = new Uint8Array(b.i), d2 = b.j, e = d2.length, g2 = 0, f2 = 0; f2 < e; f2++) {
            var h2 = d2[f2];
            c2.set(h2, g2);
            g2 += h2.length;
          }
          b.j = [c2];
          return c2;
        };
      }
      ;
      function Z2(a2) {
        X2.call(this, a2);
      }
      na(Z2, X2);
      var Hc = [Z2, 1, Cc, 2, Y2, 3, Dc, 4, Dc];
      Z2.prototype.l = Gc(Hc);
      function Ic(a2) {
        X2.call(this, a2, -1, Jc);
      }
      na(Ic, X2);
      Ic.prototype.addClassification = function(a2, b) {
        Qb(this, 1, Z2, a2, b);
        return this;
      };
      var Jc = [1], Kc = Fc([Ic, 1, Ec, Hc]);
      function Lc(a2) {
        X2.call(this, a2);
      }
      na(Lc, X2);
      var Mc = [Lc, 1, Y2, 2, Y2, 3, Y2, 4, Y2, 5, Y2];
      Lc.prototype.l = Gc(Mc);
      function Nc(a2) {
        X2.call(this, a2, -1, Oc);
      }
      na(Nc, X2);
      var Oc = [1], Pc = Fc([Nc, 1, Ec, Mc]);
      function Qc(a2) {
        X2.call(this, a2);
      }
      na(Qc, X2);
      var Rc = [Qc, 1, Y2, 2, Y2, 3, Y2, 4, Y2, 5, Y2, 6, Bc], Sc = Fc(Rc);
      Qc.prototype.l = Gc(Rc);
      function Tc(a2, b, c2) {
        c2 = a2.createShader(0 === c2 ? a2.VERTEX_SHADER : a2.FRAGMENT_SHADER);
        a2.shaderSource(c2, b);
        a2.compileShader(c2);
        if (!a2.getShaderParameter(c2, a2.COMPILE_STATUS)) throw Error("Could not compile WebGL shader.\n\n" + a2.getShaderInfoLog(c2));
        return c2;
      }
      ;
      function Uc(a2) {
        return Ob(a2, Z2, 1).map(function(b) {
          var c2 = S(b, 1);
          return { index: null == c2 ? 0 : c2, qa: W2(b, 2), label: null != S(b, 3) ? Rb(S(b, 3), "") : void 0, displayName: null != S(b, 4) ? Rb(S(b, 4), "") : void 0 };
        });
      }
      ;
      function Vc(a2) {
        return { x: W2(a2, 1), y: W2(a2, 2), z: W2(a2, 3), visibility: null != Mb(a2, 4) ? W2(a2, 4) : void 0 };
      }
      ;
      function Wc(a2, b) {
        this.i = a2;
        this.h = b;
        this.m = 0;
      }
      function Xc(a2, b, c2) {
        Yc(a2, b);
        if ("function" === typeof a2.h.canvas.transferToImageBitmap) return Promise.resolve(a2.h.canvas.transferToImageBitmap());
        if (c2) return Promise.resolve(a2.h.canvas);
        if ("function" === typeof createImageBitmap) return createImageBitmap(a2.h.canvas);
        void 0 === a2.j && (a2.j = document.createElement("canvas"));
        return new Promise(function(d2) {
          a2.j.height = a2.h.canvas.height;
          a2.j.width = a2.h.canvas.width;
          a2.j.getContext("2d", {}).drawImage(a2.h.canvas, 0, 0, a2.h.canvas.width, a2.h.canvas.height);
          d2(a2.j);
        });
      }
      function Yc(a2, b) {
        var c2 = a2.h;
        if (void 0 === a2.s) {
          var d2 = Tc(c2, "\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }", 0), e = Tc(c2, "\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }", 1), g2 = c2.createProgram();
          c2.attachShader(g2, d2);
          c2.attachShader(g2, e);
          c2.linkProgram(g2);
          if (!c2.getProgramParameter(g2, c2.LINK_STATUS)) throw Error("Could not compile WebGL program.\n\n" + c2.getProgramInfoLog(g2));
          d2 = a2.s = g2;
          c2.useProgram(d2);
          e = c2.getUniformLocation(d2, "sampler0");
          a2.l = { O: c2.getAttribLocation(d2, "aVertex"), N: c2.getAttribLocation(d2, "aTex"), ya: e };
          a2.v = c2.createBuffer();
          c2.bindBuffer(c2.ARRAY_BUFFER, a2.v);
          c2.enableVertexAttribArray(a2.l.O);
          c2.vertexAttribPointer(a2.l.O, 2, c2.FLOAT, false, 0, 0);
          c2.bufferData(c2.ARRAY_BUFFER, new Float32Array([-1, -1, -1, 1, 1, 1, 1, -1]), c2.STATIC_DRAW);
          c2.bindBuffer(c2.ARRAY_BUFFER, null);
          a2.u = c2.createBuffer();
          c2.bindBuffer(c2.ARRAY_BUFFER, a2.u);
          c2.enableVertexAttribArray(a2.l.N);
          c2.vertexAttribPointer(
            a2.l.N,
            2,
            c2.FLOAT,
            false,
            0,
            0
          );
          c2.bufferData(c2.ARRAY_BUFFER, new Float32Array([0, 1, 0, 0, 1, 0, 1, 1]), c2.STATIC_DRAW);
          c2.bindBuffer(c2.ARRAY_BUFFER, null);
          c2.uniform1i(e, 0);
        }
        d2 = a2.l;
        c2.useProgram(a2.s);
        c2.canvas.width = b.width;
        c2.canvas.height = b.height;
        c2.viewport(0, 0, b.width, b.height);
        c2.activeTexture(c2.TEXTURE0);
        a2.i.bindTexture2d(b.glName);
        c2.enableVertexAttribArray(d2.O);
        c2.bindBuffer(c2.ARRAY_BUFFER, a2.v);
        c2.vertexAttribPointer(d2.O, 2, c2.FLOAT, false, 0, 0);
        c2.enableVertexAttribArray(d2.N);
        c2.bindBuffer(c2.ARRAY_BUFFER, a2.u);
        c2.vertexAttribPointer(
          d2.N,
          2,
          c2.FLOAT,
          false,
          0,
          0
        );
        c2.bindFramebuffer(c2.DRAW_FRAMEBUFFER ? c2.DRAW_FRAMEBUFFER : c2.FRAMEBUFFER, null);
        c2.clearColor(0, 0, 0, 0);
        c2.clear(c2.COLOR_BUFFER_BIT);
        c2.colorMask(true, true, true, true);
        c2.drawArrays(c2.TRIANGLE_FAN, 0, 4);
        c2.disableVertexAttribArray(d2.O);
        c2.disableVertexAttribArray(d2.N);
        c2.bindBuffer(c2.ARRAY_BUFFER, null);
        a2.i.bindTexture2d(0);
      }
      function Zc(a2) {
        this.h = a2;
      }
      ;
      var $c = new Uint8Array([0, 97, 115, 109, 1, 0, 0, 0, 1, 4, 1, 96, 0, 0, 3, 2, 1, 0, 10, 9, 1, 7, 0, 65, 0, 253, 15, 26, 11]);
      function ad(a2, b) {
        return b + a2;
      }
      function bd(a2, b) {
        window[a2] = b;
      }
      function cd(a2) {
        var b = document.createElement("script");
        b.setAttribute("src", a2);
        b.setAttribute("crossorigin", "anonymous");
        return new Promise(function(c2) {
          b.addEventListener("load", function() {
            c2();
          }, false);
          b.addEventListener("error", function() {
            c2();
          }, false);
          document.body.appendChild(b);
        });
      }
      function dd() {
        return E(function(a2) {
          switch (a2.h) {
            case 1:
              return a2.s = 2, D2(a2, WebAssembly.instantiate($c), 4);
            case 4:
              a2.h = 3;
              a2.s = 0;
              break;
            case 2:
              return a2.s = 0, a2.l = null, a2.return(false);
            case 3:
              return a2.return(true);
          }
        });
      }
      function ed(a2) {
        this.h = a2;
        this.listeners = {};
        this.l = {};
        this.L = {};
        this.s = {};
        this.v = {};
        this.M = this.u = this.ga = true;
        this.I = Promise.resolve();
        this.fa = "";
        this.D = {};
        this.locateFile = a2 && a2.locateFile || ad;
        if ("object" === typeof window) var b = window.location.pathname.toString().substring(0, window.location.pathname.toString().lastIndexOf("/")) + "/";
        else if ("undefined" !== typeof location) b = location.pathname.toString().substring(0, location.pathname.toString().lastIndexOf("/")) + "/";
        else throw Error("solutions can only be loaded on a web page or in a web worker");
        this.ha = b;
        if (a2.options) {
          b = A2(Object.keys(a2.options));
          for (var c2 = b.next(); !c2.done; c2 = b.next()) {
            c2 = c2.value;
            var d2 = a2.options[c2].default;
            void 0 !== d2 && (this.l[c2] = "function" === typeof d2 ? d2() : d2);
          }
        }
      }
      x = ed.prototype;
      x.close = function() {
        this.j && this.j.delete();
        return Promise.resolve();
      };
      function fd(a2) {
        var b, c2, d2, e, g2, f2, h2, k, l2, m2, r2;
        return E(function(p2) {
          switch (p2.h) {
            case 1:
              if (!a2.ga) return p2.return();
              b = void 0 === a2.h.files ? [] : "function" === typeof a2.h.files ? a2.h.files(a2.l) : a2.h.files;
              return D2(p2, dd(), 2);
            case 2:
              c2 = p2.i;
              if ("object" === typeof window) return bd("createMediapipeSolutionsWasm", { locateFile: a2.locateFile }), bd("createMediapipeSolutionsPackedAssets", { locateFile: a2.locateFile }), f2 = b.filter(function(n) {
                return void 0 !== n.data;
              }), h2 = b.filter(function(n) {
                return void 0 === n.data;
              }), k = Promise.all(f2.map(function(n) {
                var q2 = gd(a2, n.url);
                if (void 0 !== n.path) {
                  var t = n.path;
                  q2 = q2.then(function(w) {
                    a2.overrideFile(t, w);
                    return Promise.resolve(w);
                  });
                }
                return q2;
              })), l2 = Promise.all(h2.map(function(n) {
                return void 0 === n.simd || n.simd && c2 || !n.simd && !c2 ? cd(a2.locateFile(n.url, a2.ha)) : Promise.resolve();
              })).then(function() {
                var n, q2, t;
                return E(function(w) {
                  if (1 == w.h) return n = window.createMediapipeSolutionsWasm, q2 = window.createMediapipeSolutionsPackedAssets, t = a2, D2(w, n(q2), 2);
                  t.i = w.i;
                  w.h = 0;
                });
              }), m2 = function() {
                return E(function(n) {
                  a2.h.graph && a2.h.graph.url ? n = D2(
                    n,
                    gd(a2, a2.h.graph.url),
                    0
                  ) : (n.h = 0, n = void 0);
                  return n;
                });
              }(), D2(p2, Promise.all([l2, k, m2]), 7);
              if ("function" !== typeof importScripts) throw Error("solutions can only be loaded on a web page or in a web worker");
              d2 = b.filter(function(n) {
                return void 0 === n.simd || n.simd && c2 || !n.simd && !c2;
              }).map(function(n) {
                return a2.locateFile(n.url, a2.ha);
              });
              importScripts.apply(null, ea(d2));
              e = a2;
              return D2(p2, createMediapipeSolutionsWasm(Module), 6);
            case 6:
              e.i = p2.i;
              a2.m = new OffscreenCanvas(1, 1);
              a2.i.canvas = a2.m;
              g2 = a2.i.GL.createContext(a2.m, {
                antialias: false,
                alpha: false,
                va: "undefined" !== typeof WebGL2RenderingContext ? 2 : 1
              });
              a2.i.GL.makeContextCurrent(g2);
              p2.h = 4;
              break;
            case 7:
              a2.m = document.createElement("canvas");
              r2 = a2.m.getContext("webgl2", {});
              if (!r2 && (r2 = a2.m.getContext("webgl", {}), !r2)) return alert("Failed to create WebGL canvas context when passing video frame."), p2.return();
              a2.K = r2;
              a2.i.canvas = a2.m;
              a2.i.createContext(a2.m, true, true, {});
            case 4:
              a2.j = new a2.i.SolutionWasm(), a2.ga = false, p2.h = 0;
          }
        });
      }
      function hd(a2) {
        var b, c2, d2, e, g2, f2, h2, k;
        return E(function(l2) {
          if (1 == l2.h) {
            if (a2.h.graph && a2.h.graph.url && a2.fa === a2.h.graph.url) return l2.return();
            a2.u = true;
            if (!a2.h.graph || !a2.h.graph.url) {
              l2.h = 2;
              return;
            }
            a2.fa = a2.h.graph.url;
            return D2(l2, gd(a2, a2.h.graph.url), 3);
          }
          2 != l2.h && (b = l2.i, a2.j.loadGraph(b));
          c2 = A2(Object.keys(a2.D));
          for (d2 = c2.next(); !d2.done; d2 = c2.next()) e = d2.value, a2.j.overrideFile(e, a2.D[e]);
          a2.D = {};
          if (a2.h.listeners) for (g2 = A2(a2.h.listeners), f2 = g2.next(); !f2.done; f2 = g2.next()) h2 = f2.value, id(a2, h2);
          k = a2.l;
          a2.l = {};
          a2.setOptions(k);
          l2.h = 0;
        });
      }
      x.reset = function() {
        var a2 = this;
        return E(function(b) {
          a2.j && (a2.j.reset(), a2.s = {}, a2.v = {});
          b.h = 0;
        });
      };
      x.setOptions = function(a2, b) {
        var c2 = this;
        if (b = b || this.h.options) {
          for (var d2 = [], e = [], g2 = {}, f2 = A2(Object.keys(a2)), h2 = f2.next(); !h2.done; g2 = { X: g2.X, Y: g2.Y }, h2 = f2.next()) if (h2 = h2.value, !(h2 in this.l && this.l[h2] === a2[h2])) {
            this.l[h2] = a2[h2];
            var k = b[h2];
            void 0 !== k && (k.onChange && (g2.X = k.onChange, g2.Y = a2[h2], d2.push(/* @__PURE__ */ function(l2) {
              return function() {
                var m2;
                return E(function(r2) {
                  if (1 == r2.h) return D2(r2, l2.X(l2.Y), 2);
                  m2 = r2.i;
                  true === m2 && (c2.u = true);
                  r2.h = 0;
                });
              };
            }(g2))), k.graphOptionXref && (h2 = Object.assign(
              {},
              { calculatorName: "", calculatorIndex: 0 },
              k.graphOptionXref,
              { valueNumber: 1 === k.type ? a2[h2] : 0, valueBoolean: 0 === k.type ? a2[h2] : false, valueString: 2 === k.type ? a2[h2] : "" }
            ), e.push(h2)));
          }
          if (0 !== d2.length || 0 !== e.length) this.u = true, this.H = (void 0 === this.H ? [] : this.H).concat(e), this.F = (void 0 === this.F ? [] : this.F).concat(d2);
        }
      };
      function jd(a2) {
        var b, c2, d2, e, g2, f2, h2;
        return E(function(k) {
          switch (k.h) {
            case 1:
              if (!a2.u) return k.return();
              if (!a2.F) {
                k.h = 2;
                break;
              }
              b = A2(a2.F);
              c2 = b.next();
            case 3:
              if (c2.done) {
                k.h = 5;
                break;
              }
              d2 = c2.value;
              return D2(k, d2(), 4);
            case 4:
              c2 = b.next();
              k.h = 3;
              break;
            case 5:
              a2.F = void 0;
            case 2:
              if (a2.H) {
                e = new a2.i.GraphOptionChangeRequestList();
                g2 = A2(a2.H);
                for (f2 = g2.next(); !f2.done; f2 = g2.next()) h2 = f2.value, e.push_back(h2);
                a2.j.changeOptions(e);
                e.delete();
                a2.H = void 0;
              }
              a2.u = false;
              k.h = 0;
          }
        });
      }
      x.initialize = function() {
        var a2 = this;
        return E(function(b) {
          return 1 == b.h ? D2(b, fd(a2), 2) : 3 != b.h ? D2(b, hd(a2), 3) : D2(b, jd(a2), 0);
        });
      };
      function gd(a2, b) {
        var c2, d2;
        return E(function(e) {
          if (b in a2.L) return e.return(a2.L[b]);
          c2 = a2.locateFile(b, "");
          d2 = fetch(c2).then(function(g2) {
            return g2.arrayBuffer();
          });
          a2.L[b] = d2;
          return e.return(d2);
        });
      }
      x.overrideFile = function(a2, b) {
        this.j ? this.j.overrideFile(a2, b) : this.D[a2] = b;
      };
      x.clearOverriddenFiles = function() {
        this.D = {};
        this.j && this.j.clearOverriddenFiles();
      };
      x.send = function(a2, b) {
        var c2 = this, d2, e, g2, f2, h2, k, l2, m2, r2;
        return E(function(p2) {
          switch (p2.h) {
            case 1:
              if (!c2.h.inputs) return p2.return();
              d2 = 1e3 * (void 0 === b || null === b ? performance.now() : b);
              return D2(p2, c2.I, 2);
            case 2:
              return D2(p2, c2.initialize(), 3);
            case 3:
              e = new c2.i.PacketDataList();
              g2 = A2(Object.keys(a2));
              for (f2 = g2.next(); !f2.done; f2 = g2.next()) if (h2 = f2.value, k = c2.h.inputs[h2]) {
                a: {
                  var n = a2[h2];
                  switch (k.type) {
                    case "video":
                      var q2 = c2.s[k.stream];
                      q2 || (q2 = new Wc(c2.i, c2.K), c2.s[k.stream] = q2);
                      0 === q2.m && (q2.m = q2.i.createTexture());
                      if ("undefined" !== typeof HTMLVideoElement && n instanceof HTMLVideoElement) {
                        var t = n.videoWidth;
                        var w = n.videoHeight;
                      } else "undefined" !== typeof HTMLImageElement && n instanceof HTMLImageElement ? (t = n.naturalWidth, w = n.naturalHeight) : (t = n.width, w = n.height);
                      w = { glName: q2.m, width: t, height: w };
                      t = q2.h;
                      t.canvas.width = w.width;
                      t.canvas.height = w.height;
                      t.activeTexture(t.TEXTURE0);
                      q2.i.bindTexture2d(q2.m);
                      t.texImage2D(t.TEXTURE_2D, 0, t.RGBA, t.RGBA, t.UNSIGNED_BYTE, n);
                      q2.i.bindTexture2d(0);
                      q2 = w;
                      break a;
                    case "detections":
                      q2 = c2.s[k.stream];
                      q2 || (q2 = new Zc(c2.i), c2.s[k.stream] = q2);
                      q2.data || (q2.data = new q2.h.DetectionListData());
                      q2.data.reset(n.length);
                      for (w = 0; w < n.length; ++w) {
                        t = n[w];
                        var v2 = q2.data, B2 = v2.setBoundingBox, J2 = w;
                        var I = t.la;
                        var u2 = new Qc();
                        V2(u2, 1, I.sa);
                        V2(u2, 2, I.ta);
                        V2(u2, 3, I.height);
                        V2(u2, 4, I.width);
                        V2(u2, 5, I.rotation);
                        U(u2, 6, I.pa);
                        I = u2.l();
                        B2.call(v2, J2, I);
                        if (t.ea) for (v2 = 0; v2 < t.ea.length; ++v2) {
                          u2 = t.ea[v2];
                          B2 = q2.data;
                          J2 = B2.addNormalizedLandmark;
                          I = w;
                          u2 = Object.assign({}, u2, { visibility: u2.visibility ? u2.visibility : 0 });
                          var C2 = new Lc();
                          V2(C2, 1, u2.x);
                          V2(C2, 2, u2.y);
                          V2(C2, 3, u2.z);
                          u2.visibility && V2(C2, 4, u2.visibility);
                          u2 = C2.l();
                          J2.call(
                            B2,
                            I,
                            u2
                          );
                        }
                        if (t.ba) for (v2 = 0; v2 < t.ba.length; ++v2) B2 = q2.data, J2 = B2.addClassification, I = w, u2 = t.ba[v2], C2 = new Z2(), V2(C2, 2, u2.qa), u2.index && U(C2, 1, u2.index), u2.label && U(C2, 3, u2.label), u2.displayName && U(C2, 4, u2.displayName), u2 = C2.l(), J2.call(B2, I, u2);
                      }
                      q2 = q2.data;
                      break a;
                    default:
                      q2 = {};
                  }
                }
                l2 = q2;
                m2 = k.stream;
                switch (k.type) {
                  case "video":
                    e.pushTexture2d(Object.assign({}, l2, { stream: m2, timestamp: d2 }));
                    break;
                  case "detections":
                    r2 = l2;
                    r2.stream = m2;
                    r2.timestamp = d2;
                    e.pushDetectionList(r2);
                    break;
                  default:
                    throw Error("Unknown input config type: '" + k.type + "'");
                }
              }
              c2.j.send(e);
              return D2(p2, c2.I, 4);
            case 4:
              e.delete(), p2.h = 0;
          }
        });
      };
      function kd(a2, b, c2) {
        var d2, e, g2, f2, h2, k, l2, m2, r2, p2, n, q2, t, w;
        return E(function(v2) {
          switch (v2.h) {
            case 1:
              if (!c2) return v2.return(b);
              d2 = {};
              e = 0;
              g2 = A2(Object.keys(c2));
              for (f2 = g2.next(); !f2.done; f2 = g2.next()) h2 = f2.value, k = c2[h2], "string" !== typeof k && "texture" === k.type && void 0 !== b[k.stream] && ++e;
              1 < e && (a2.M = false);
              l2 = A2(Object.keys(c2));
              f2 = l2.next();
            case 2:
              if (f2.done) {
                v2.h = 4;
                break;
              }
              m2 = f2.value;
              r2 = c2[m2];
              if ("string" === typeof r2) return t = d2, w = m2, D2(v2, ld(a2, m2, b[r2]), 14);
              p2 = b[r2.stream];
              if ("detection_list" === r2.type) {
                if (p2) {
                  var B2 = p2.getRectList();
                  for (var J2 = p2.getLandmarksList(), I = p2.getClassificationsList(), u2 = [], C2 = 0; C2 < B2.size(); ++C2) {
                    var T = Sc(B2.get(C2)), od = W2(T, 1), pd = W2(T, 2), qd = W2(T, 3), rd = W2(T, 4), sd = W2(T, 5, 0), za = void 0;
                    za = void 0 === za ? 0 : za;
                    T = { la: { sa: od, ta: pd, height: qd, width: rd, rotation: sd, pa: Rb(S(T, 6), za) }, ea: Ob(Pc(J2.get(C2)), Lc, 1).map(Vc), ba: Uc(Kc(I.get(C2))) };
                    u2.push(T);
                  }
                  B2 = u2;
                } else B2 = [];
                d2[m2] = B2;
                v2.h = 7;
                break;
              }
              if ("proto_list" === r2.type) {
                if (p2) {
                  B2 = Array(p2.size());
                  for (J2 = 0; J2 < p2.size(); J2++) B2[J2] = p2.get(J2);
                  p2.delete();
                } else B2 = [];
                d2[m2] = B2;
                v2.h = 7;
                break;
              }
              if (void 0 === p2) {
                v2.h = 3;
                break;
              }
              if ("float_list" === r2.type) {
                d2[m2] = p2;
                v2.h = 7;
                break;
              }
              if ("proto" === r2.type) {
                d2[m2] = p2;
                v2.h = 7;
                break;
              }
              if ("texture" !== r2.type) throw Error("Unknown output config type: '" + r2.type + "'");
              n = a2.v[m2];
              n || (n = new Wc(a2.i, a2.K), a2.v[m2] = n);
              return D2(v2, Xc(n, p2, a2.M), 13);
            case 13:
              q2 = v2.i, d2[m2] = q2;
            case 7:
              r2.transform && d2[m2] && (d2[m2] = r2.transform(d2[m2]));
              v2.h = 3;
              break;
            case 14:
              t[w] = v2.i;
            case 3:
              f2 = l2.next();
              v2.h = 2;
              break;
            case 4:
              return v2.return(d2);
          }
        });
      }
      function ld(a2, b, c2) {
        var d2;
        return E(function(e) {
          return "number" === typeof c2 || c2 instanceof Uint8Array || c2 instanceof a2.i.Uint8BlobList ? e.return(c2) : c2 instanceof a2.i.Texture2dDataOut ? (d2 = a2.v[b], d2 || (d2 = new Wc(a2.i, a2.K), a2.v[b] = d2), e.return(Xc(d2, c2, a2.M))) : e.return(void 0);
        });
      }
      function id(a2, b) {
        for (var c2 = b.name || "$", d2 = [].concat(ea(b.wants)), e = new a2.i.StringList(), g2 = A2(b.wants), f2 = g2.next(); !f2.done; f2 = g2.next()) e.push_back(f2.value);
        g2 = a2.i.PacketListener.implement({ onResults: function(h2) {
          for (var k = {}, l2 = 0; l2 < b.wants.length; ++l2) k[d2[l2]] = h2.get(l2);
          var m2 = a2.listeners[c2];
          m2 && (a2.I = kd(a2, k, b.outs).then(function(r2) {
            r2 = m2(r2);
            for (var p2 = 0; p2 < b.wants.length; ++p2) {
              var n = k[d2[p2]];
              "object" === typeof n && n.hasOwnProperty && n.hasOwnProperty("delete") && n.delete();
            }
            r2 && (a2.I = r2);
          }));
        } });
        a2.j.attachMultiListener(e, g2);
        e.delete();
      }
      x.onResults = function(a2, b) {
        this.listeners[b || "$"] = a2;
      };
      Aa("Solution", ed);
      Aa("OptionType", { BOOL: 0, NUMBER: 1, ua: 2, 0: "BOOL", 1: "NUMBER", 2: "STRING" });
      function md(a2) {
        void 0 === a2 && (a2 = 0);
        switch (a2) {
          case 1:
            return "selfie_segmentation_landscape.tflite";
          default:
            return "selfie_segmentation.tflite";
        }
      }
      function nd(a2) {
        var b = this;
        a2 = a2 || {};
        this.h = new ed({ locateFile: a2.locateFile, files: function(c2) {
          return [{ simd: true, url: "selfie_segmentation_solution_simd_wasm_bin.js" }, { simd: false, url: "selfie_segmentation_solution_wasm_bin.js" }, { data: true, url: md(c2.modelSelection) }];
        }, graph: { url: "selfie_segmentation.binarypb" }, listeners: [{ wants: ["segmentation_mask", "image_transformed"], outs: { image: { type: "texture", stream: "image_transformed" }, segmentationMask: { type: "texture", stream: "segmentation_mask" } } }], inputs: { image: {
          type: "video",
          stream: "input_frames_gpu"
        } }, options: { useCpuInference: { type: 0, graphOptionXref: { calculatorType: "InferenceCalculator", fieldName: "use_cpu_inference" }, default: "object" !== typeof window || void 0 === window.navigator ? false : "iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform) || navigator.userAgent.includes("Mac") && "ontouchend" in document }, selfieMode: { type: 0, graphOptionXref: { calculatorType: "GlScalerCalculator", calculatorIndex: 1, fieldName: "flip_horizontal" } }, modelSelection: {
          type: 1,
          graphOptionXref: { calculatorType: "ConstantSidePacketCalculator", calculatorName: "ConstantSidePacketCalculatorModelSelection", fieldName: "int_value" },
          onChange: function(c2) {
            var d2, e, g2;
            return E(function(f2) {
              if (1 == f2.h) return d2 = md(c2), e = "third_party/mediapipe/modules/selfie_segmentation/" + d2, D2(f2, gd(b.h, d2), 2);
              g2 = f2.i;
              b.h.overrideFile(e, g2);
              return f2.return(true);
            });
          }
        } } });
      }
      x = nd.prototype;
      x.close = function() {
        this.h.close();
        return Promise.resolve();
      };
      x.onResults = function(a2) {
        this.h.onResults(a2);
      };
      x.initialize = function() {
        var a2 = this;
        return E(function(b) {
          return D2(b, a2.h.initialize(), 0);
        });
      };
      x.reset = function() {
        this.h.reset();
      };
      x.send = function(a2) {
        var b = this;
        return E(function(c2) {
          return D2(c2, b.h.send(a2), 0);
        });
      };
      x.setOptions = function(a2) {
        this.h.setOptions(a2);
      };
      Aa("SelfieSegmentation", nd);
      Aa("VERSION", "0.1.1675465747");
    }).call(exports);
  }
});

// node_modules/@tensorflow-models/body-segmentation/dist/body-segmentation.esm.js
var import_selfie_segmentation = __toESM(require_selfie_segmentation());
var R = function(t, e) {
  return R = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t2, e2) {
    t2.__proto__ = e2;
  } || function(t2, e2) {
    for (var n in e2) e2.hasOwnProperty(n) && (t2[n] = e2[n]);
  }, R(t, e);
};
function F(t, e) {
  function n() {
    this.constructor = t;
  }
  R(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
}
var C = function() {
  return C = Object.assign || function(t) {
    for (var e, n = 1, r2 = arguments.length; n < r2; n++) for (var i2 in e = arguments[n]) Object.prototype.hasOwnProperty.call(e, i2) && (t[i2] = e[i2]);
    return t;
  }, C.apply(this, arguments);
};
function D(t, e, n, r2) {
  return new (n || (n = Promise))(function(i2, o2) {
    function a2(t2) {
      try {
        u2(r2.next(t2));
      } catch (t3) {
        o2(t3);
      }
    }
    function s2(t2) {
      try {
        u2(r2.throw(t2));
      } catch (t3) {
        o2(t3);
      }
    }
    function u2(t2) {
      var e2;
      t2.done ? i2(t2.value) : (e2 = t2.value, e2 instanceof n ? e2 : new n(function(t3) {
        t3(e2);
      })).then(a2, s2);
    }
    u2((r2 = r2.apply(t, e || [])).next());
  });
}
function B(t, e) {
  var n, r2, i2, o2, a2 = { label: 0, sent: function() {
    if (1 & i2[0]) throw i2[1];
    return i2[1];
  }, trys: [], ops: [] };
  return o2 = { next: s2(0), throw: s2(1), return: s2(2) }, "function" == typeof Symbol && (o2[Symbol.iterator] = function() {
    return this;
  }), o2;
  function s2(o3) {
    return function(s3) {
      return function(o4) {
        if (n) throw new TypeError("Generator is already executing.");
        for (; a2; ) try {
          if (n = 1, r2 && (i2 = 2 & o4[0] ? r2.return : o4[0] ? r2.throw || ((i2 = r2.return) && i2.call(r2), 0) : r2.next) && !(i2 = i2.call(r2, o4[1])).done) return i2;
          switch (r2 = 0, i2 && (o4 = [2 & o4[0], i2.value]), o4[0]) {
            case 0:
            case 1:
              i2 = o4;
              break;
            case 4:
              return a2.label++, { value: o4[1], done: false };
            case 5:
              a2.label++, r2 = o4[1], o4 = [0];
              continue;
            case 7:
              o4 = a2.ops.pop(), a2.trys.pop();
              continue;
            default:
              if (!(i2 = a2.trys, (i2 = i2.length > 0 && i2[i2.length - 1]) || 6 !== o4[0] && 2 !== o4[0])) {
                a2 = 0;
                continue;
              }
              if (3 === o4[0] && (!i2 || o4[1] > i2[0] && o4[1] < i2[3])) {
                a2.label = o4[1];
                break;
              }
              if (6 === o4[0] && a2.label < i2[1]) {
                a2.label = i2[1], i2 = o4;
                break;
              }
              if (i2 && a2.label < i2[2]) {
                a2.label = i2[2], a2.ops.push(o4);
                break;
              }
              i2[2] && a2.ops.pop(), a2.trys.pop();
              continue;
          }
          o4 = e.call(t, a2);
        } catch (t2) {
          o4 = [6, t2], r2 = 0;
        } finally {
          n = i2 = 0;
        }
        if (5 & o4[0]) throw o4[1];
        return { value: o4[0] ? o4[1] : void 0, done: true };
      }([o3, s3]);
    };
  }
}
function L(t) {
  return t instanceof SVGAnimatedLength ? t.baseVal.value : t;
}
function z(t) {
  return D(this, void 0, void 0, function() {
    var r2, i2;
    return B(this, function(o2) {
      switch (o2.label) {
        case 0:
          return r2 = document.createElement("canvas"), t instanceof Tensor ? [4, browser_exports.toPixels(t, r2)] : [3, 2];
        case 1:
          return o2.sent(), [3, 3];
        case 2:
          r2.width = L(t.width), r2.height = L(t.height), i2 = r2.getContext("2d"), t instanceof ImageData ? i2.putImageData(t, 0, 0) : i2.drawImage(t, 0, 0), o2.label = 3;
        case 3:
          return [2, r2];
      }
    });
  });
}
function W(t) {
  return D(this, void 0, void 0, function() {
    var r2, i2, o2, a2, s2, u2;
    return B(this, function(f2) {
      switch (f2.label) {
        case 0:
          return t instanceof Tensor ? (r2 = t.shape.slice(0, 2), i2 = r2[0], o2 = r2[1], a2 = ImageData.bind, [4, browser_exports.toPixels(t)]) : [3, 2];
        case 1:
          return [2, new (a2.apply(ImageData, [void 0, f2.sent(), o2, i2]))()];
        case 2:
          return s2 = document.createElement("canvas"), u2 = s2.getContext("2d"), s2.width = L(t.width), s2.height = L(t.height), u2.drawImage(t, 0, 0), [2, u2.getImageData(0, 0, s2.width, s2.height)];
      }
    });
  });
}
function j(t) {
  return D(this, void 0, void 0, function() {
    var e, r2;
    return B(this, function(i2) {
      switch (i2.label) {
        case 0:
          return t instanceof SVGImageElement || t instanceof OffscreenCanvas ? [4, z(t)] : [3, 2];
        case 1:
          return r2 = i2.sent(), [3, 3];
        case 2:
          r2 = t, i2.label = 3;
        case 3:
          return e = r2, [2, browser_exports.fromPixels(e, 4)];
      }
    });
  });
}
function V(t) {
  if (t < 0 || t >= 256) throw new Error("Mask value must be in range [0, 255] but got " + t);
  if (!Number.isInteger(t)) throw new Error("Mask value must be an integer but got " + t);
}
function q(t) {
  var e = t.shape[2], n = argMax(t, 2), r2 = reshape(n, [-1]);
  return oneHot(r2, e);
}
function N(t, e) {
  return tidy(function() {
    return cast(greater(t, scalar(e)), "int32");
  });
}
function Q(t, e) {
  var n = e.shape, o2 = n[0], s2 = n[1], m2 = n[2];
  return tidy(function() {
    var n2 = q(e), r2 = expandDims(range(0, m2, 1, "int32"), 1), g2 = cast(matMul(n2, r2), "int32"), v2 = reshape(g2, [o2, s2]), w = add(v2, scalar(1, "int32"));
    return sub(function(t2, e2) {
      return mul(t2, e2);
    }(w, t), scalar(1, "int32"));
  });
}
var X = function() {
  function t(t2, e) {
    this.model = t2, this.outputStride = e;
    var n = this.model.inputs[0].shape;
    util_exports.assert(-1 === n[1] && -1 === n[2], function() {
      return "Input shape [" + n[1] + ", " + n[2] + "] must both be equal to or -1";
    });
  }
  return t.prototype.predict = function(t2) {
    var e = this;
    return tidy(function() {
      var n = e.preprocessInput(cast(t2, "float32")), r2 = expandDims(n, 0), o2 = e.model.predict(r2).map(function(t3) {
        return squeeze(t3, [0]);
      }), a2 = e.nameOutputResults(o2);
      return { heatmapScores: sigmoid(a2.heatmap), offsets: a2.offsets, displacementFwd: a2.displacementFwd, displacementBwd: a2.displacementBwd, segmentation: a2.segmentation, partHeatmaps: a2.partHeatmaps, longOffsets: a2.longOffsets, partOffsets: a2.partOffsets };
    });
  }, t.prototype.dispose = function() {
    this.model.dispose();
  }, t;
}();
var Y = function(t) {
  function e() {
    return null !== t && t.apply(this, arguments) || this;
  }
  return F(e, t), e.prototype.preprocessInput = function(t2) {
    return tidy(function() {
      return sub(div(t2, 127.5), 1);
    });
  }, e.prototype.nameOutputResults = function(t2) {
    return { offsets: t2[0], segmentation: t2[1], partHeatmaps: t2[2], longOffsets: t2[3], heatmap: t2[4], displacementFwd: t2[5], displacementBwd: t2[6], partOffsets: t2[7] };
  }, e;
}(X);
var G = ["nose", "leftEye", "rightEye", "leftEar", "rightEar", "leftShoulder", "rightShoulder", "leftElbow", "rightElbow", "leftWrist", "rightWrist", "leftHip", "rightHip", "leftKnee", "rightKnee", "leftAnkle", "rightAnkle"];
var $ = G.length;
var J = G.reduce(function(t, e, n) {
  return t[e] = n, t;
}, {});
[["leftHip", "leftShoulder"], ["leftElbow", "leftShoulder"], ["leftElbow", "leftWrist"], ["leftHip", "leftKnee"], ["leftKnee", "leftAnkle"], ["rightHip", "rightShoulder"], ["rightElbow", "rightShoulder"], ["rightElbow", "rightWrist"], ["rightHip", "rightKnee"], ["rightKnee", "rightAnkle"], ["leftShoulder", "rightShoulder"], ["leftHip", "rightHip"]].map(function(t) {
  var e = t[0], n = t[1];
  return [J[e], J[n]];
});
function Z(t, e, n) {
  var r2 = t[0], i2 = t[1], o2 = e[0], a2 = e[1], s2 = n.top, u2 = n.bottom;
  return [a2 / (n.left + n.right + i2), o2 / (s2 + u2 + r2)];
}
function tt(t, e, n, r2) {
  return { y: r2.get(t, e, n), x: r2.get(t, e, n + $) };
}
function et(t, e, n) {
  var r2 = tt(t.heatmapY, t.heatmapX, t.id, n), i2 = r2.y, o2 = r2.x;
  return { x: t.heatmapX * e + o2, y: t.heatmapY * e + i2 };
}
function nt(t, e, n) {
  return t < e ? e : t > n ? n : t;
}
function rt(t, e) {
  return { x: t.x + e.x, y: t.y + e.y };
}
function it(t, e, n) {
  void 0 === n && (n = 0.3);
  for (var r2 = 0, i2 = 0, o2 = 0; o2 < t.length; o2++) e.keypoints[o2].score > n && (i2 += 1, r2 += Math.pow(t[o2].x - e.keypoints[o2].position.x, 2) + Math.pow(t[o2].y - e.keypoints[o2].position.y, 2));
  return 0 === i2 ? r2 = 1 / 0 : r2 /= i2, r2;
}
function ot(t, e, n, r2, i2, o2, a2) {
  for (var s2 = a2[0], u2 = a2[1], f2 = n(t), l2 = f2.y * r2 + f2.x, c2 = i2[$ * (2 * l2) + e], d2 = i2[$ * (2 * l2 + 1) + e], h2 = t.y + c2, p2 = t.x + d2, m2 = 0; m2 < o2; m2++) {
    h2 = Math.min(h2, s2 - 1);
    var g2 = n({ x: p2 = Math.min(p2, u2 - 1), y: h2 }), v2 = g2.y * r2 + g2.x;
    h2 += c2 = i2[$ * (2 * v2) + e], p2 += d2 = i2[$ * (2 * v2 + 1) + e];
  }
  return { x: p2, y: h2 };
}
function at(t, e, n, r2, i2, o2, a2, s2, u2, f2) {
  for (var l2 = i2[0], c2 = i2[1], d2 = o2[0], h2 = o2[1], p2 = s2[0], m2 = s2[1], g2 = [], v2 = function(t2) {
    return function(t3, e2, n2, r3) {
      var i3 = e2[0], o3 = e2[1], a3 = n2[0], s3 = n2[1], u3 = Math.round(((i3 + t3.y + 1) * s3 - 1) / r3);
      return { x: Math.round(((o3 + t3.x + 1) * a3 - 1) / r3), y: u3 };
    }(t2, [l2, c2], [d2, h2], u2);
  }, w = 0; w < r2; w++) {
    var y = ot(t, w, v2, a2, e, f2, [p2, m2]);
    g2.push(y);
  }
  for (var b = -1, S = 1 / 0, x = 0; x < n.length; x++) {
    var M = it(g2, n[x]);
    M < S && (b = x, S = M);
  }
  return b;
}
function st(t, e) {
  var n = t[0], r2 = t[1];
  return [Math.round((r2 - 1) / e + 1), Math.round((n - 1) / e + 1)];
}
function ut(t, e, n, r2, i2, o2, a2, s2, u2, f2, l2) {
  for (var d2 = a2[0], h2 = a2[1], p2 = t.shape, m2 = p2[0], g2 = p2[1], v2 = e.shape.slice(0, 2), w = v2[0], y = v2[1], x = reshape(e, [w, y, 2, $]), M = new Float32Array(l2 * $ * 3).fill(0), k = 0; k < n.length; k++) for (var E = k * $ * 3, T = n[k], P = 0; P < $; P++) {
    var I = T.keypoints[P], O = E + 3 * P;
    M[O] = I.score, M[O + 1] = I.position.y, M[O + 2] = I.position.x;
  }
  var _ = Z([r2, i2], [d2, h2], s2), H = _[0], A2 = _[1], R2 = tensor(M, [l2, $, 3]), F2 = s2.top, C2 = s2.left, D2 = { variableNames: ["segmentation", "longOffsets", "poses"], outputShape: [m2, g2], userCode: "\n    int convertToPositionInOutput(int pos, int pad, float scale, int stride) {\n      return round(((float(pos + pad) + 1.0) * scale - 1.0) / float(stride));\n    }\n\n    float convertToPositionInOutputFloat(\n        int pos, int pad, float scale, int stride) {\n      return ((float(pos + pad) + 1.0) * scale - 1.0) / float(stride);\n    }\n\n    float dist(float x1, float y1, float x2, float y2) {\n      return pow(x1 - x2, 2.0) + pow(y1 - y2, 2.0);\n    }\n\n    float sampleLongOffsets(float h, float w, int d, int k) {\n      float fh = fract(h);\n      float fw = fract(w);\n      int clH = int(ceil(h));\n      int clW = int(ceil(w));\n      int flH = int(floor(h));\n      int flW = int(floor(w));\n      float o11 = getLongOffsets(flH, flW, d, k);\n      float o12 = getLongOffsets(flH, clW, d, k);\n      float o21 = getLongOffsets(clH, flW, d, k);\n      float o22 = getLongOffsets(clH, clW, d, k);\n      float o1 = mix(o11, o12, fw);\n      float o2 = mix(o21, o22, fw);\n      return mix(o1, o2, fh);\n    }\n\n    int findNearestPose(int h, int w) {\n      float prob = getSegmentation(h, w);\n      if (prob < 1.0) {\n        return -1;\n      }\n\n      // Done(Tyler): convert from output space h/w to strided space.\n      float stridedH = convertToPositionInOutputFloat(\n        h, " + F2 + ", " + A2 + ", " + o2 + ");\n      float stridedW = convertToPositionInOutputFloat(\n        w, " + C2 + ", " + H + ", " + o2 + ");\n\n      float minDist = 1000000.0;\n      int iMin = -1;\n      for (int i = 0; i < " + l2 + "; i++) {\n        float curDistSum = 0.0;\n        int numKpt = 0;\n        for (int k = 0; k < " + $ + "; k++) {\n          float dy = sampleLongOffsets(stridedH, stridedW, 0, k);\n          float dx = sampleLongOffsets(stridedH, stridedW, 1, k);\n\n          float y = float(h) + dy;\n          float x = float(w) + dx;\n\n          for (int s = 0; s < " + u2 + "; s++) {\n            int yRounded = round(min(y, float(" + (r2 - 1) + ")));\n            int xRounded = round(min(x, float(" + (i2 - 1) + ")));\n\n            float yStrided = convertToPositionInOutputFloat(\n              yRounded, " + F2 + ", " + A2 + ", " + o2 + ");\n            float xStrided = convertToPositionInOutputFloat(\n              xRounded, " + C2 + ", " + H + ", " + o2 + ");\n\n            float dy = sampleLongOffsets(yStrided, xStrided, 0, k);\n            float dx = sampleLongOffsets(yStrided, xStrided, 1, k);\n\n            y = y + dy;\n            x = x + dx;\n          }\n\n          float poseScore = getPoses(i, k, 0);\n          float poseY = getPoses(i, k, 1);\n          float poseX = getPoses(i, k, 2);\n          if (poseScore > " + f2 + ") {\n            numKpt = numKpt + 1;\n            curDistSum = curDistSum + dist(x, y, poseX, poseY);\n          }\n        }\n        if (numKpt > 0 && curDistSum / float(numKpt) < minDist) {\n          minDist = curDistSum / float(numKpt);\n          iMin = i;\n        }\n      }\n      return iMin;\n    }\n\n    void main() {\n        ivec2 coords = getOutputCoords();\n        int nearestPose = findNearestPose(coords[0], coords[1]);\n        setOutput(float(nearestPose));\n      }\n  " };
  return backend().compileAndRun(D2, [t, x, R2]);
}
function ft() {
  return "webgl" === getBackend();
}
function lt(t, e, n, o2, s2, u2, f2, l2, c2, d2, h2, p2) {
  var m2 = f2[0], g2 = f2[1];
  return void 0 === c2 && (c2 = 0.2), void 0 === d2 && (d2 = 8), void 0 === h2 && (h2 = 0.3), void 0 === p2 && (p2 = 10), D(this, void 0, void 0, function() {
    var f3, v2, w, y, b;
    return B(this, function(S) {
      switch (S.label) {
        case 0:
          return f3 = n.filter(function(t2) {
            return t2.score >= c2;
          }), ft() ? (w = tidy(function() {
            var n2 = ut(t, e, f3, o2, s2, u2, [m2, g2], l2, d2, h2, p2), c3 = engine().makeTensorFromDataId(n2.dataId, n2.shape, n2.dtype);
            return f3.map(function(t2, e2) {
              return function(t3, e3) {
                return tidy(function() {
                  return cast(equal(t3, scalar(e3)), "int32");
                });
              }(c3, e2);
            });
          }), [4, Promise.all(w.map(function(t2) {
            return t2.data();
          }))]) : [3, 2];
        case 1:
          return v2 = S.sent(), w.forEach(function(t2) {
            return t2.dispose();
          }), [3, 5];
        case 2:
          return [4, t.data()];
        case 3:
          return y = S.sent(), [4, e.data()];
        case 4:
          b = S.sent(), v2 = function(t2, e2, n2, r2, i2, o3, a2, s3, u3, f4) {
            var l3 = a2[0], c3 = a2[1];
            void 0 === f4 && (f4 = 5);
            for (var d3 = n2.map(function(t3) {
              return new Uint8Array(r2 * i2).fill(0);
            }), h3 = s3.top, p3 = s3.left, m3 = Z([r2, i2], [l3, c3], s3), g3 = m3[0], v3 = m3[1], w2 = st([l3, c3], o3)[0], y2 = 0; y2 < r2; y2 += 1) for (var b2 = 0; b2 < i2; b2 += 1) {
              var S2 = y2 * i2 + b2;
              if (1 === t2[S2]) {
                var x = at({ x: b2, y: y2 }, e2, n2, f4, [h3, p3], [g3, v3], w2, [r2, i2], o3, u3);
                x >= 0 && (d3[x][S2] = 1);
              }
            }
            return d3;
          }(y, b, f3, o2, s2, u2, [m2, g2], l2, d2), S.label = 5;
        case 5:
          return [2, v2.map(function(t2, e2) {
            return { data: t2, pose: f3[e2], width: s2, height: o2 };
          })];
      }
    });
  });
}
function ct(t, e, n, o2, s2, u2, f2, l2, c2, m2, g2, v2, w) {
  var y = l2[0], b = l2[1];
  return void 0 === m2 && (m2 = 0.2), void 0 === g2 && (g2 = 8), void 0 === v2 && (v2 = 0.3), void 0 === w && (w = 10), D(this, void 0, void 0, function() {
    var l3, S, x, E, T, P;
    return B(this, function(I) {
      switch (I.label) {
        case 0:
          return l3 = o2.filter(function(t2) {
            return t2.score >= m2;
          }), ft() ? (x = tidy(function() {
            var o3 = ut(t, e, l3, s2, u2, f2, [y, b], c2, g2, v2, w), m3 = engine().makeTensorFromDataId(o3.dataId, o3.shape, o3.dtype);
            return l3.map(function(t2, e2) {
              return function(t3, e3, n2) {
                return tidy(function() {
                  return sub(mul(cast(equal(t3, scalar(n2)), "int32"), add(e3, 1)), 1);
                });
              }(m3, n, e2);
            });
          }), [4, Promise.all(x.map(function(t2) {
            return t2.data();
          }))]) : [3, 2];
        case 1:
          return S = I.sent(), x.forEach(function(t2) {
            return t2.dispose();
          }), [3, 6];
        case 2:
          return [4, t.data()];
        case 3:
          return E = I.sent(), [4, e.data()];
        case 4:
          return T = I.sent(), [4, n.data()];
        case 5:
          P = I.sent(), S = function(t2, e2, n2, r2, i2, o3, a2, s3, u3, f3, l4) {
            var c3 = s3[0], d2 = s3[1];
            void 0 === l4 && (l4 = 5);
            for (var h2 = r2.map(function(t3) {
              return new Int32Array(i2 * o3).fill(-1);
            }), p2 = u3.top, m3 = u3.left, g3 = Z([i2, o3], [c3, d2], u3), v3 = g3[0], w2 = g3[1], y2 = st([c3, d2], a2)[0], b2 = 0; b2 < i2; b2 += 1) for (var S2 = 0; S2 < o3; S2 += 1) {
              var x2 = b2 * o3 + S2;
              if (1 === t2[x2]) {
                var M = at({ x: S2, y: b2 }, e2, r2, l4, [p2, m3], [v3, w2], y2, [i2, o3], a2, f3);
                M >= 0 && (h2[M][x2] = n2[x2]);
              }
            }
            return h2;
          }(E, T, P, l3, s2, u2, f2, [y, b], c2, g2), I.label = 6;
        case 6:
          return [2, S.map(function(t2, e2) {
            return { pose: l3[e2], data: t2, height: s2, width: u2 };
          })];
      }
    });
  });
}
function dt(t) {
  return Math.floor(t / 2);
}
var ht = function() {
  function t(t2, e) {
    this.priorityQueue = new Array(t2), this.numberOfElements = -1, this.getElementValue = e;
  }
  return t.prototype.enqueue = function(t2) {
    this.priorityQueue[++this.numberOfElements] = t2, this.swim(this.numberOfElements);
  }, t.prototype.dequeue = function() {
    var t2 = this.priorityQueue[0];
    return this.exchange(0, this.numberOfElements--), this.sink(0), this.priorityQueue[this.numberOfElements + 1] = null, t2;
  }, t.prototype.empty = function() {
    return -1 === this.numberOfElements;
  }, t.prototype.size = function() {
    return this.numberOfElements + 1;
  }, t.prototype.all = function() {
    return this.priorityQueue.slice(0, this.numberOfElements + 1);
  }, t.prototype.max = function() {
    return this.priorityQueue[0];
  }, t.prototype.swim = function(t2) {
    for (; t2 > 0 && this.less(dt(t2), t2); ) this.exchange(t2, dt(t2)), t2 = dt(t2);
  }, t.prototype.sink = function(t2) {
    for (; 2 * t2 <= this.numberOfElements; ) {
      var e = 2 * t2;
      if (e < this.numberOfElements && this.less(e, e + 1) && e++, !this.less(t2, e)) break;
      this.exchange(t2, e), t2 = e;
    }
  }, t.prototype.getValueAt = function(t2) {
    return this.getElementValue(this.priorityQueue[t2]);
  }, t.prototype.less = function(t2, e) {
    return this.getValueAt(t2) < this.getValueAt(e);
  }, t.prototype.exchange = function(t2, e) {
    var n = this.priorityQueue[t2];
    this.priorityQueue[t2] = this.priorityQueue[e], this.priorityQueue[e] = n;
  }, t;
}();
function pt(t, e, n, r2, i2, o2) {
  for (var a2 = o2.shape, s2 = a2[0], u2 = a2[1], f2 = true, l2 = Math.max(n - i2, 0), c2 = Math.min(n + i2 + 1, s2), d2 = l2; d2 < c2; ++d2) {
    for (var h2 = Math.max(r2 - i2, 0), p2 = Math.min(r2 + i2 + 1, u2), m2 = h2; m2 < p2; ++m2) if (o2.get(d2, m2, t) > e) {
      f2 = false;
      break;
    }
    if (!f2) break;
  }
  return f2;
}
var mt = [["nose", "leftEye"], ["leftEye", "leftEar"], ["nose", "rightEye"], ["rightEye", "rightEar"], ["nose", "leftShoulder"], ["leftShoulder", "leftElbow"], ["leftElbow", "leftWrist"], ["leftShoulder", "leftHip"], ["leftHip", "leftKnee"], ["leftKnee", "leftAnkle"], ["nose", "rightShoulder"], ["rightShoulder", "rightElbow"], ["rightElbow", "rightWrist"], ["rightShoulder", "rightHip"], ["rightHip", "rightKnee"], ["rightKnee", "rightAnkle"]].map(function(t) {
  var e = t[0], n = t[1];
  return [J[e], J[n]];
});
var gt = mt.map(function(t) {
  return t[1];
});
var vt = mt.map(function(t) {
  return t[0];
});
function wt(t, e, n, r2) {
  return { y: nt(Math.round(t.y / e), 0, n - 1), x: nt(Math.round(t.x / e), 0, r2 - 1) };
}
function yt(t, e, n, r2, i2, o2, a2, s2) {
  void 0 === s2 && (s2 = 2);
  for (var u2 = r2.shape, f2 = u2[0], l2 = u2[1], c2 = function(t2, e2, n2) {
    var r3 = n2.shape[2] / 2;
    return { y: n2.get(e2.y, e2.x, t2), x: n2.get(e2.y, e2.x, r3 + t2) };
  }(t, wt(e.position, o2, f2, l2), a2), d2 = rt(e.position, c2), h2 = 0; h2 < s2; h2++) {
    var p2 = wt(d2, o2, f2, l2), m2 = tt(p2.y, p2.x, n, i2);
    d2 = rt({ x: p2.x * o2, y: p2.y * o2 }, { x: m2.x, y: m2.y });
  }
  var g2 = wt(d2, o2, f2, l2), v2 = r2.get(g2.y, g2.x, n);
  return { position: d2, part: G[n], score: v2 };
}
function bt(t, e, n, r2, i2, o2) {
  var a2 = e.shape[2], s2 = gt.length, u2 = new Array(a2), f2 = t.part, l2 = t.score, c2 = et(f2, r2, n);
  u2[f2.id] = { score: l2, part: G[f2.id], position: c2 };
  for (var d2 = s2 - 1; d2 >= 0; --d2) {
    var h2 = gt[d2], p2 = vt[d2];
    u2[h2] && !u2[p2] && (u2[p2] = yt(d2, u2[h2], p2, e, n, r2, o2));
  }
  for (d2 = 0; d2 < s2; ++d2) {
    h2 = vt[d2], p2 = gt[d2];
    u2[h2] && !u2[p2] && (u2[p2] = yt(d2, u2[h2], p2, e, n, r2, i2));
  }
  return u2;
}
function St(t, e, n, r2) {
  var i2 = n.x, o2 = n.y;
  return t.some(function(t2) {
    var n2, a2, s2, u2, f2, l2, c2 = t2.keypoints[r2].position;
    return n2 = o2, a2 = i2, s2 = c2.y, u2 = c2.x, (f2 = s2 - n2) * f2 + (l2 = u2 - a2) * l2 <= e;
  });
}
function xt(t, e, n) {
  var r2 = n.reduce(function(n2, r3, i2) {
    var o2 = r3.position, a2 = r3.score;
    return St(t, e, o2, i2) || (n2 += a2), n2;
  }, 0);
  return r2 / n.length;
}
function Mt(t, e, n, r2, i2, o2, a2, s2) {
  void 0 === a2 && (a2 = 0.5), void 0 === s2 && (s2 = 20);
  for (var u2 = [], f2 = function(t2, e2, n2) {
    for (var r3 = n2.shape, i3 = r3[0], o3 = r3[1], a3 = r3[2], s3 = new ht(i3 * o3 * a3, function(t3) {
      return t3.score;
    }), u3 = 0; u3 < i3; ++u3) for (var f3 = 0; f3 < o3; ++f3) for (var l3 = 0; l3 < a3; ++l3) {
      var c3 = n2.get(u3, f3, l3);
      c3 < t2 || pt(l3, c3, u3, f3, e2, n2) && s3.enqueue({ score: c3, part: { heatmapY: u3, heatmapX: f3, id: l3 } });
    }
    return s3;
  }(a2, 1, t), l2 = s2 * s2; u2.length < o2 && !f2.empty(); ) {
    var c2 = f2.dequeue();
    if (!St(u2, l2, et(c2.part, i2, e), c2.part.id)) {
      var d2 = bt(c2, t, e, i2, n, r2), h2 = xt(u2, l2, d2);
      u2.push({ keypoints: d2, score: h2 });
    }
  }
  return u2;
}
var kt;
var Et = [-123.15, -115.9, -103.06];
var Tt = function(t) {
  function e() {
    return null !== t && t.apply(this, arguments) || this;
  }
  return F(e, t), e.prototype.preprocessInput = function(t2) {
    return add(t2, Et);
  }, e.prototype.nameOutputResults = function(t2) {
    var e2 = t2[0], n = t2[1], r2 = t2[2], i2 = t2[3], o2 = t2[4], a2 = t2[5];
    return { offsets: o2, segmentation: t2[6], partHeatmaps: a2, longOffsets: i2, heatmap: r2, displacementFwd: n, displacementBwd: e2, partOffsets: t2[7] };
  }, e;
}(X);
var Pt = "https://storage.googleapis.com/tfjs-models/savedmodel/bodypix/resnet50/";
var It = "https://storage.googleapis.com/tfjs-models/savedmodel/bodypix/mobilenet/";
function Ot(t) {
  if ("undefined" != typeof HTMLCanvasElement && t instanceof HTMLCanvasElement || "undefined" != typeof OffscreenCanvas && t instanceof OffscreenCanvas || "undefined" != typeof HTMLImageElement && t instanceof HTMLImageElement) return function(t2) {
    if ("offsetHeight" in t2 && 0 !== t2.offsetHeight && "offsetWidth" in t2 && 0 !== t2.offsetWidth) return [t2.offsetHeight, t2.offsetWidth];
    if (null != t2.height && null != t2.width) return [t2.height, t2.width];
    throw new Error("HTMLImageElement must have height and width attributes set.");
  }(t);
  if ("undefined" != typeof ImageData && t instanceof ImageData) return [t.height, t.width];
  if ("undefined" != typeof HTMLVideoElement && t instanceof HTMLVideoElement) return function(t2) {
    return t2.hasAttribute("height") && t2.hasAttribute("width") ? [t2.height, t2.width] : [t2.videoHeight, t2.videoWidth];
  }(t);
  if (t instanceof Tensor) return [t.shape[0], t.shape[1]];
  throw new Error("error: Unknown input type: " + t + ".");
}
function _t(t, e) {
  return function(t2, e2) {
    return (t2 - 1) % e2 == 0;
  }(t, e) ? t : Math.floor(t / e) * e + 1;
}
var Ht = { low: "low", medium: "medium", high: "high", full: "full" };
var At = ((kt = {})[Ht.low] = 0.25, kt[Ht.medium] = 0.5, kt[Ht.high] = 0.75, kt[Ht.full] = 1, kt);
function Rt(t, e, n) {
  var r2 = n[0], i2 = n[1], o2 = function(t2) {
    if ("string" == typeof t2) {
      var e2 = At[t2];
      return util_exports.assert("number" == typeof e2, function() {
        return "string value of inputResolution must be one of " + Object.values(Ht).join(",") + " but was " + t2 + ".";
      }), e2;
    }
    return util_exports.assert("number" == typeof t2 && t2 <= 2 && t2 >= 0.1, function() {
      return "inputResolution must be a string or number between 0.1 and 2, but was " + t2;
    }), t2;
  }(t);
  return [_t(r2 * o2, e), _t(i2 * o2, e)];
}
function Ft(t, e, n, i2, o2) {
  var a2 = e[0], s2 = e[1], f2 = n[0], l2 = n[1], c2 = i2[0], d2 = c2[0], h2 = c2[1], p2 = i2[1], m2 = p2[0], w = p2[1];
  return void 0 === o2 && (o2 = false), tidy(function() {
    var e2 = image.resizeBilinear(t, [f2, l2], true);
    return o2 && (e2 = sigmoid(e2)), function(t2, e3, n2) {
      var i3 = e3[0], o3 = e3[1], a3 = n2[0], s3 = a3[0], f3 = a3[1], l3 = n2[1], c3 = l3[0], d3 = l3[1];
      return tidy(function() {
        var e4 = expandDims(t2);
        return squeeze(image.cropAndResize(e4, [[s3 / (i3 + s3 + f3 - 1), c3 / (o3 + c3 + d3 - 1), (s3 + i3 - 1) / (i3 + s3 + f3 - 1), (c3 + o3 - 1) / (o3 + c3 + d3 - 1)]], [0], [i3, o3]), [0]);
      });
    }(e2, [a2, s2], [[d2, h2], [m2, w]]);
  });
}
function Ct(t, i2) {
  var o2 = i2[0], a2 = i2[1], s2 = Ot(t), u2 = s2[0], f2 = s2[1], l2 = a2 / o2, c2 = [0, 0, 0, 0], d2 = c2[0], h2 = c2[1], p2 = c2[2], m2 = c2[3];
  f2 / u2 < l2 ? (d2 = 0, h2 = 0, p2 = Math.round(0.5 * (l2 * u2 - f2)), m2 = Math.round(0.5 * (l2 * u2 - f2))) : (d2 = Math.round(0.5 * (1 / l2 * f2 - u2)), h2 = Math.round(0.5 * (1 / l2 * f2 - u2)), p2 = 0, m2 = 0);
  var g2 = tidy(function() {
    var r2 = function(t2) {
      return t2 instanceof Tensor ? t2 : browser_exports.fromPixels(t2);
    }(t);
    return r2 = pad3d(r2, [[d2, h2], [p2, m2], [0, 0]]), image.resizeBilinear(r2, [o2, a2]);
  });
  return { resized: g2, padding: { top: d2, left: p2, right: m2, bottom: h2 } };
}
function Dt(t) {
  return D(this, void 0, void 0, function() {
    return B(this, function(e) {
      return [2, Promise.all(t.map(function(t2) {
        return t2.buffer();
      }))];
    });
  });
}
function Bt(t, e, n, r2, i2) {
  var o2 = e[0], a2 = e[1], s2 = n[0], u2 = n[1], f2 = function(t2, e2, n2, r3, i3) {
    return void 0 === r3 && (r3 = 0), void 0 === i3 && (i3 = 0), 1 === n2 && 1 === e2 && 0 === r3 && 0 === i3 ? t2 : t2.map(function(t3) {
      return function(t4, e3, n3, r4, i4) {
        return void 0 === r4 && (r4 = 0), void 0 === i4 && (i4 = 0), { score: t4.score, keypoints: t4.keypoints.map(function(t5) {
          var o3 = t5.score, a3 = t5.part, s3 = t5.position;
          return { score: o3, part: a3, position: { x: s3.x * n3 + i4, y: s3.y * e3 + r4 } };
        }) };
      }(t3, e2, n2, r3, i3);
    });
  }(t, (o2 + r2.top + r2.bottom) / s2, (a2 + r2.left + r2.right) / u2, -r2.top, -r2.left);
  return i2 ? function(t2, e2) {
    return e2 <= 0 ? t2 : t2.map(function(t3) {
      return function(t4, e3) {
        return { score: t4.score, keypoints: t4.keypoints.map(function(t5) {
          var n2 = t5.score, r3 = t5.part, i3 = t5.position;
          return { score: n2, part: r3, position: { x: e3 - 1 - i3.x, y: i3.y } };
        }) };
      }(t3, e2);
    });
  }(f2, a2) : f2;
}
var Lt = { architecture: "MobileNetV1", outputStride: 16, quantBytes: 4, multiplier: 0.75 };
var zt = ["MobileNetV1", "ResNet50"];
var Wt = { MobileNetV1: [8, 16, 32], ResNet50: [32, 16] };
var jt = { MobileNetV1: [0.5, 0.75, 1], ResNet50: [1] };
var Vt = [1, 2, 4];
var Kt = { flipHorizontal: false, internalResolution: "medium", segmentationThreshold: 0.7, maxDetections: 10, scoreThreshold: 0.4, nmsRadius: 20 };
var Ut = { flipHorizontal: false, internalResolution: "medium", segmentationThreshold: 0.7, maxDetections: 10, scoreThreshold: 0.4, nmsRadius: 20, minKeypointScore: 0.3, refineSteps: 10 };
function qt(t) {
  var e = t.segmentationThreshold, n = t.maxDetections, r2 = t.scoreThreshold, i2 = t.nmsRadius;
  if (e < 0 || e > 1) throw new Error("segmentationThreshold " + e + ". Should be in range [0.0, 1.0]");
  if (n <= 0) throw new Error("Invalid maxDetections " + n + ". Should be > 0");
  if (r2 < 0 || r2 > 1) throw new Error("Invalid scoreThreshold " + r2 + ". Should be in range [0.0, 1.0]");
  if (i2 <= 0) throw new Error("Invalid nmsRadius " + i2 + ".");
}
function Nt(t) {
  var e = t.segmentationThreshold, n = t.maxDetections, r2 = t.scoreThreshold, i2 = t.nmsRadius, o2 = t.minKeypointScore, a2 = t.refineSteps;
  if (e < 0 || e > 1) throw new Error("segmentationThreshold " + e + ". Should be in range [0.0, 1.0]");
  if (n <= 0) throw new Error("Invalid maxDetections " + n + ". Should be > 0");
  if (r2 < 0 || r2 > 1) throw new Error("Invalid scoreThreshold " + r2 + ". Should be in range [0.0, 1.0]");
  if (i2 <= 0) throw new Error("Invalid nmsRadius " + i2 + ".");
  if (o2 < 0 || o2 > 1) throw new Error("Invalid minKeypointScore " + o2 + ".Should be in range [0.0, 1.0]");
  if (a2 <= 0 || a2 > 20) throw new Error("Invalid refineSteps " + a2 + ".Should be in range [1, 20]");
}
var Qt = function() {
  function t(t2) {
    this.baseModel = t2;
  }
  return t.prototype.predictForPersonSegmentation = function(t2) {
    var e = this.baseModel.predict(t2);
    return { segmentLogits: e.segmentation, heatmapScores: e.heatmapScores, offsets: e.offsets, displacementFwd: e.displacementFwd, displacementBwd: e.displacementBwd };
  }, t.prototype.predictForPersonSegmentationAndPart = function(t2) {
    var e = this.baseModel.predict(t2);
    return { segmentLogits: e.segmentation, partHeatmapLogits: e.partHeatmaps, heatmapScores: e.heatmapScores, offsets: e.offsets, displacementFwd: e.displacementFwd, displacementBwd: e.displacementBwd };
  }, t.prototype.predictForMultiPersonInstanceSegmentationAndPart = function(t2) {
    var e = this.baseModel.predict(t2);
    return { segmentLogits: e.segmentation, longOffsets: e.longOffsets, heatmapScores: e.heatmapScores, offsets: e.offsets, displacementFwd: e.displacementFwd, displacementBwd: e.displacementBwd, partHeatmaps: e.partHeatmaps };
  }, t.prototype.segmentPersonActivation = function(t2, e, n) {
    var i2 = this;
    void 0 === n && (n = 0.5);
    var o2 = Ot(t2), a2 = o2[0], s2 = o2[1], u2 = Rt(e, this.baseModel.outputStride, [a2, s2]), f2 = Ct(t2, u2), l2 = f2.resized, c2 = f2.padding, d2 = tidy(function() {
      var t3 = i2.predictForPersonSegmentation(l2), e2 = t3.segmentLogits, r2 = t3.heatmapScores, o3 = t3.offsets, u3 = t3.displacementFwd, f3 = t3.displacementBwd, d3 = l2.shape, h3 = d3[0], p3 = d3[1], m3 = Ft(e2, [a2, s2], [h3, p3], [[c2.top, c2.bottom], [c2.left, c2.right]], true);
      return { segmentation: N(squeeze(m3), n), heatmapScores: r2, offsets: o3, displacementFwd: u3, displacementBwd: f3 };
    }), h2 = d2.segmentation, p2 = d2.heatmapScores, m2 = d2.offsets, v2 = d2.displacementFwd, w = d2.displacementBwd;
    return l2.dispose(), { segmentation: h2, heatmapScores: p2, offsets: m2, displacementFwd: v2, displacementBwd: w, padding: c2, internalResolutionHeightAndWidth: u2 };
  }, t.prototype.segmentPerson = function(t2, e) {
    return void 0 === e && (e = Kt), D(this, void 0, void 0, function() {
      var n, r2, i2, o2, a2, s2, u2, f2, l2, c2, d2, h2, p2, m2, g2, v2, w, y;
      return B(this, function(b) {
        switch (b.label) {
          case 0:
            return qt(e = C(C({}, Kt), e)), n = this.segmentPersonActivation(t2, e.internalResolution, e.segmentationThreshold), r2 = n.segmentation, i2 = n.heatmapScores, o2 = n.offsets, a2 = n.displacementFwd, s2 = n.displacementBwd, u2 = n.padding, f2 = n.internalResolutionHeightAndWidth, l2 = r2.shape, c2 = l2[0], d2 = l2[1], [4, r2.data()];
          case 1:
            return h2 = b.sent(), r2.dispose(), [4, Dt([i2, o2, a2, s2])];
          case 2:
            return p2 = b.sent(), m2 = p2[0], g2 = p2[1], v2 = p2[2], w = p2[3], y = Bt(y = Mt(m2, g2, v2, w, this.baseModel.outputStride, e.maxDetections, e.scoreThreshold, e.nmsRadius), [c2, d2], f2, u2, false), i2.dispose(), o2.dispose(), a2.dispose(), s2.dispose(), [2, { height: c2, width: d2, data: h2, allPoses: y }];
        }
      });
    });
  }, t.prototype.segmentMultiPerson = function(t2, e) {
    return void 0 === e && (e = Ut), D(this, void 0, void 0, function() {
      var n, i2, o2, a2, s2, u2, f2, l2, c2, d2, h2, p2, m2, v2, w, y, b, S, x, M, k, E = this;
      return B(this, function(T) {
        switch (T.label) {
          case 0:
            return Nt(e = C(C({}, Ut), e)), n = Ot(t2), i2 = n[0], o2 = n[1], a2 = Rt(e.internalResolution, this.baseModel.outputStride, [i2, o2]), s2 = Ct(t2, a2), u2 = s2.resized, f2 = s2.padding, l2 = tidy(function() {
              var t3, n2 = E.predictForMultiPersonInstanceSegmentationAndPart(u2), r2 = n2.segmentLogits, s3 = n2.longOffsets, l3 = n2.heatmapScores, c3 = n2.offsets, d3 = n2.displacementFwd, h3 = n2.displacementBwd, p3 = Ft(r2, [i2, o2], a2, [[f2.top, f2.bottom], [f2.left, f2.right]], true);
              return t3 = s3, { segmentation: N(squeeze(p3), e.segmentationThreshold), longOffsets: t3, heatmapScoresRaw: l3, offsetsRaw: c3, displacementFwdRaw: d3, displacementBwdRaw: h3 };
            }), c2 = l2.segmentation, d2 = l2.longOffsets, h2 = l2.heatmapScoresRaw, p2 = l2.offsetsRaw, m2 = l2.displacementFwdRaw, v2 = l2.displacementBwdRaw, [4, Dt([h2, p2, m2, v2])];
          case 1:
            return w = T.sent(), y = w[0], b = w[1], S = w[2], x = w[3], M = Bt(M = Mt(y, b, S, x, this.baseModel.outputStride, e.maxDetections, e.scoreThreshold, e.nmsRadius), [i2, o2], a2, f2, false), [4, lt(c2, d2, M, i2, o2, this.baseModel.outputStride, a2, f2, e.scoreThreshold, e.refineSteps, e.minKeypointScore, e.maxDetections)];
          case 2:
            return k = T.sent(), u2.dispose(), c2.dispose(), d2.dispose(), h2.dispose(), p2.dispose(), m2.dispose(), v2.dispose(), [2, k];
        }
      });
    });
  }, t.prototype.segmentPersonPartsActivation = function(t2, e, n) {
    var i2 = this;
    void 0 === n && (n = 0.5);
    var o2 = Ot(t2), a2 = o2[0], s2 = o2[1], u2 = Rt(e, this.baseModel.outputStride, [a2, s2]), f2 = Ct(t2, u2), l2 = f2.resized, c2 = f2.padding, d2 = tidy(function() {
      var t3 = i2.predictForPersonSegmentationAndPart(l2), e2 = t3.segmentLogits, r2 = t3.partHeatmapLogits, o3 = t3.heatmapScores, u3 = t3.offsets, f3 = t3.displacementFwd, d3 = t3.displacementBwd, h3 = l2.shape, p3 = h3[0], m3 = h3[1], v3 = Ft(e2, [a2, s2], [p3, m3], [[c2.top, c2.bottom], [c2.left, c2.right]], true), w2 = Ft(r2, [a2, s2], [p3, m3], [[c2.top, c2.bottom], [c2.left, c2.right]], true);
      return { partSegmentation: Q(N(squeeze(v3), n), w2), heatmapScores: o3, offsets: u3, displacementFwd: f3, displacementBwd: d3 };
    }), h2 = d2.partSegmentation, p2 = d2.heatmapScores, m2 = d2.offsets, v2 = d2.displacementFwd, w = d2.displacementBwd;
    return l2.dispose(), { partSegmentation: h2, heatmapScores: p2, offsets: m2, displacementFwd: v2, displacementBwd: w, padding: c2, internalResolutionHeightAndWidth: u2 };
  }, t.prototype.segmentPersonParts = function(t2, e) {
    return void 0 === e && (e = Kt), D(this, void 0, void 0, function() {
      var n, r2, i2, o2, a2, s2, u2, f2, l2, c2, d2, h2, p2, m2, g2, v2, w, y;
      return B(this, function(b) {
        switch (b.label) {
          case 0:
            return qt(e = C(C({}, Kt), e)), n = this.segmentPersonPartsActivation(t2, e.internalResolution, e.segmentationThreshold), r2 = n.partSegmentation, i2 = n.heatmapScores, o2 = n.offsets, a2 = n.displacementFwd, s2 = n.displacementBwd, u2 = n.padding, f2 = n.internalResolutionHeightAndWidth, l2 = r2.shape, c2 = l2[0], d2 = l2[1], [4, r2.data()];
          case 1:
            return h2 = b.sent(), r2.dispose(), [4, Dt([i2, o2, a2, s2])];
          case 2:
            return p2 = b.sent(), m2 = p2[0], g2 = p2[1], v2 = p2[2], w = p2[3], y = Bt(y = Mt(m2, g2, v2, w, this.baseModel.outputStride, e.maxDetections, e.scoreThreshold, e.nmsRadius), [c2, d2], f2, u2, false), i2.dispose(), o2.dispose(), a2.dispose(), s2.dispose(), [2, { height: c2, width: d2, data: h2, allPoses: y }];
        }
      });
    });
  }, t.prototype.segmentMultiPersonParts = function(t2, e) {
    return void 0 === e && (e = Ut), D(this, void 0, void 0, function() {
      var n, o2, a2, s2, d2, h2, p2, m2, v2, w, y, b, S, x, M, k, E, T, P, I, O, _, H = this;
      return B(this, function(A2) {
        switch (A2.label) {
          case 0:
            return Nt(e = C(C({}, Ut), e)), n = Ot(t2), o2 = n[0], a2 = n[1], s2 = Rt(e.internalResolution, this.baseModel.outputStride, [o2, a2]), d2 = Ct(t2, s2), h2 = d2.resized, p2 = d2.padding, m2 = tidy(function() {
              var t3 = H.predictForMultiPersonInstanceSegmentationAndPart(h2), n2 = t3.segmentLogits, d3 = t3.longOffsets, m3 = t3.heatmapScores, v3 = t3.offsets, w2 = t3.displacementFwd, y2 = t3.displacementBwd, b2 = t3.partHeatmaps, S2 = Ft(n2, [o2, a2], s2, [[p2.top, p2.bottom], [p2.left, p2.right]], true), x2 = Ft(b2, [o2, a2], s2, [[p2.top, p2.bottom], [p2.left, p2.right]], true), M2 = d3, k2 = N(squeeze(S2), e.segmentationThreshold), E2 = function(t4) {
                var e2 = t4.shape, n3 = e2[0], o3 = e2[1], a3 = e2[2];
                return tidy(function() {
                  var e3 = q(t4), r2 = expandDims(range(0, a3, 1, "int32"), 1), s3 = cast(matMul(e3, r2), "int32");
                  return reshape(s3, [n3, o3]);
                });
              }(x2);
              return { segmentation: k2, longOffsets: M2, heatmapScoresRaw: m3, offsetsRaw: v3, displacementFwdRaw: w2, displacementBwdRaw: y2, partSegmentation: E2 };
            }), v2 = m2.segmentation, w = m2.longOffsets, y = m2.heatmapScoresRaw, b = m2.offsetsRaw, S = m2.displacementFwdRaw, x = m2.displacementBwdRaw, M = m2.partSegmentation, [4, Dt([y, b, S, x])];
          case 1:
            return k = A2.sent(), E = k[0], T = k[1], P = k[2], I = k[3], O = Bt(O = Mt(E, T, P, I, this.baseModel.outputStride, e.maxDetections, e.scoreThreshold, e.nmsRadius), [o2, a2], s2, p2, false), [4, ct(v2, w, M, O, o2, a2, this.baseModel.outputStride, s2, p2, e.scoreThreshold, e.refineSteps, e.minKeypointScore, e.maxDetections)];
          case 2:
            return _ = A2.sent(), h2.dispose(), v2.dispose(), w.dispose(), y.dispose(), b.dispose(), S.dispose(), x.dispose(), M.dispose(), [2, _];
        }
      });
    });
  }, t.prototype.dispose = function() {
    this.baseModel.dispose();
  }, t;
}();
function Xt(e) {
  return D(this, void 0, void 0, function() {
    var n, r2, i2, o2, a2, s2;
    return B(this, function(u2) {
      switch (u2.label) {
        case 0:
          if (n = e.outputStride, r2 = e.quantBytes, i2 = e.multiplier, null == dist_exports) throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this\n        model.");
          return o2 = function(t, e2, n2) {
            var r3 = { 1: "100", 0.75: "075", 0.5: "050" }, i3 = "model-stride" + t + ".json";
            return 4 === n2 ? It + "float/" + r3[e2] + "/" + i3 : It + "quant" + n2 + "/" + r3[e2] + "/" + i3;
          }(n, i2, r2), [4, loadGraphModel(e.modelUrl || o2)];
        case 1:
          return a2 = u2.sent(), s2 = new Y(a2, n), [2, new Qt(s2)];
      }
    });
  });
}
function Yt(e) {
  return D(this, void 0, void 0, function() {
    var n, r2, i2, o2, a2;
    return B(this, function(s2) {
      switch (s2.label) {
        case 0:
          if (n = e.outputStride, r2 = e.quantBytes, null == dist_exports) throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this\n        model.");
          return i2 = function(t, e2) {
            var n2 = "model-stride" + t + ".json";
            return 4 === e2 ? Pt + "float/" + n2 : Pt + "quant" + e2 + "/" + n2;
          }(n, r2), [4, loadGraphModel(e.modelUrl || i2)];
        case 1:
          return o2 = s2.sent(), a2 = new Tt(o2, n), [2, new Qt(a2)];
      }
    });
  });
}
function Gt(t) {
  return void 0 === t && (t = Lt), D(this, void 0, void 0, function() {
    return B(this, function(e) {
      return "ResNet50" === (t = function(t2) {
        if (null == (t2 = t2 || Lt).architecture && (t2.architecture = "MobileNetV1"), zt.indexOf(t2.architecture) < 0) throw new Error("Invalid architecture " + t2.architecture + ". Should be one of " + zt);
        if (null == t2.outputStride && (t2.outputStride = 16), Wt[t2.architecture].indexOf(t2.outputStride) < 0) throw new Error("Invalid outputStride " + t2.outputStride + ". Should be one of " + Wt[t2.architecture] + " for architecture " + t2.architecture + ".");
        if (null == t2.multiplier && (t2.multiplier = 1), jt[t2.architecture].indexOf(t2.multiplier) < 0) throw new Error("Invalid multiplier " + t2.multiplier + ". Should be one of " + jt[t2.architecture] + " for architecture " + t2.architecture + ".");
        if (null == t2.quantBytes && (t2.quantBytes = 4), Vt.indexOf(t2.quantBytes) < 0) throw new Error("Invalid quantBytes " + t2.quantBytes + ". Should be one of " + Vt + " for architecture " + t2.architecture + ".");
        return t2;
      }(t)).architecture ? [2, Yt(t)] : "MobileNetV1" === t.architecture ? [2, Xt(t)] : [2, null];
    });
  });
}
var $t = ["left_face", "right_face", "left_upper_arm_front", "left_upper_arm_back", "right_upper_arm_front", "right_upper_arm_back", "left_lower_arm_front", "left_lower_arm_back", "right_lower_arm_front", "right_lower_arm_back", "left_hand", "right_hand", "torso_front", "torso_back", "left_upper_leg_front", "left_upper_leg_back", "right_upper_leg_front", "right_upper_leg_back", "left_lower_leg_front", "left_lower_leg_back", "right_lower_leg_front", "right_lower_leg_back", "left_feet", "right_feet"];
var Jt = function() {
  function t(t2) {
    this.mask = t2;
  }
  return t.prototype.toCanvasImageSource = function() {
    return D(this, void 0, void 0, function() {
      return B(this, function(t2) {
        return [2, z(this.mask)];
      });
    });
  }, t.prototype.toImageData = function() {
    return D(this, void 0, void 0, function() {
      return B(this, function(t2) {
        return [2, this.mask];
      });
    });
  }, t.prototype.toTensor = function() {
    return D(this, void 0, void 0, function() {
      return B(this, function(t2) {
        return [2, j(this.mask)];
      });
    });
  }, t.prototype.getUnderlyingType = function() {
    return "imagedata";
  }, t;
}();
function Zt(t) {
  if (V(t), 255 !== t) throw new Error("Foreground id must be 255 but got " + t);
  return "person";
}
function te(t) {
  if (V(t), t >= $t.length) throw new Error("Invalid body part value " + t);
  return $t[t];
}
var ee = function() {
  function t(t2) {
    this.bodyPixModel = t2;
  }
  return t.prototype.segmentPeople = function(t2, e) {
    return D(this, void 0, void 0, function() {
      var n, r2, i2, o2;
      return B(this, function(a2) {
        switch (a2.label) {
          case 0:
            return t2 instanceof ImageBitmap && ((n = document.createElement("canvas")).getContext("2d").drawImage(t2, 0, 0), t2 = n), e.segmentBodyParts ? e.multiSegmentation ? [4, this.bodyPixModel.segmentMultiPersonParts(t2, e)] : [3, 2] : [3, 5];
          case 1:
            return i2 = a2.sent(), [3, 4];
          case 2:
            return [4, this.bodyPixModel.segmentPersonParts(t2, e)];
          case 3:
            i2 = [a2.sent()], a2.label = 4;
          case 4:
            return r2 = i2.map(function(t3) {
              var e2 = t3.data, n2 = t3.width, r3 = t3.height, i3 = new Uint8ClampedArray(n2 * r3 * 4).fill(0);
              return e2.forEach(function(t4, e3) {
                -1 === t4 ? (i3[4 * e3] = $t.length, i3[4 * e3 + 3] = 0) : (i3[4 * e3] = t4, i3[4 * e3 + 3] = 255);
              }), { maskValueToLabel: te, mask: new Jt(new ImageData(i3, n2, r3)) };
            }), [3, 10];
          case 5:
            return e.multiSegmentation ? [4, this.bodyPixModel.segmentMultiPerson(t2, e)] : [3, 7];
          case 6:
            return o2 = a2.sent(), [3, 9];
          case 7:
            return [4, this.bodyPixModel.segmentPerson(t2, e)];
          case 8:
            o2 = [a2.sent()], a2.label = 9;
          case 9:
            r2 = o2.map(function(t3) {
              var e2 = t3.data, n2 = t3.width, r3 = t3.height, i3 = new Uint8ClampedArray(n2 * r3 * 4).fill(0);
              return e2.forEach(function(t4, e3) {
                0 === t4 ? (i3[4 * e3] = 0, i3[4 * e3 + 3] = 0) : (i3[4 * e3] = 255, i3[4 * e3 + 3] = 255);
              }), { maskValueToLabel: Zt, mask: new Jt(new ImageData(i3, n2, r3)) };
            }), a2.label = 10;
          case 10:
            return [2, r2];
        }
      });
    });
  }, t.prototype.dispose = function() {
    this.bodyPixModel.dispose();
  }, t.prototype.reset = function() {
  }, t;
}();
function ne(t) {
  return D(this, void 0, void 0, function() {
    return B(this, function(e) {
      return [2, Gt(t).then(function(t2) {
        return new ee(t2);
      })];
    });
  });
}
var re = { runtime: "mediapipe", modelType: "general" };
var ie = function() {
  function t(t2) {
    this.mask = t2;
  }
  return t.prototype.toCanvasImageSource = function() {
    return D(this, void 0, void 0, function() {
      return B(this, function(t2) {
        return [2, this.mask];
      });
    });
  }, t.prototype.toImageData = function() {
    return D(this, void 0, void 0, function() {
      return B(this, function(t2) {
        return [2, W(this.mask)];
      });
    });
  }, t.prototype.toTensor = function() {
    return D(this, void 0, void 0, function() {
      return B(this, function(t2) {
        return [2, j(this.mask)];
      });
    });
  }, t.prototype.getUnderlyingType = function() {
    return "canvasimagesource";
  }, t;
}();
function oe(t) {
  return V(t), "person";
}
var ae = function() {
  function t(t2) {
    var e, n = this;
    this.selfieMode = false;
    var r2;
    if (this.selfieSegmentationSolution = new import_selfie_segmentation.SelfieSegmentation({ locateFile: null !== (e = t2.locateFile) && void 0 !== e ? e : function(e2, n2) {
      return t2.solutionPath ? t2.solutionPath.replace(/\/+$/, "") + "/" + e2 : n2 + "/" + e2;
    } }), "landscape" === t2.modelType) r2 = 1;
    else r2 = 0;
    this.selfieSegmentationSolution.setOptions({ modelSelection: r2, selfieMode: this.selfieMode }), this.selfieSegmentationSolution.onResults(function(t3) {
      n.segmentation = [{ maskValueToLabel: oe, mask: new ie(t3.segmentationMask) }];
    });
  }
  return t.prototype.segmentPeople = function(t2, r2) {
    return D(this, void 0, void 0, function() {
      var i2, o2;
      return B(this, function(a2) {
        switch (a2.label) {
          case 0:
            return r2 && r2.flipHorizontal && r2.flipHorizontal !== this.selfieMode && (this.selfieMode = r2.flipHorizontal, this.selfieSegmentationSolution.setOptions({ selfieMode: this.selfieMode })), t2 instanceof Tensor ? (o2 = ImageData.bind, [4, browser_exports.toPixels(t2)]) : [3, 2];
          case 1:
            return i2 = new (o2.apply(ImageData, [void 0, a2.sent(), t2.shape[1], t2.shape[0]]))(), [3, 3];
          case 2:
            i2 = t2, a2.label = 3;
          case 3:
            return t2 = i2, [4, this.selfieSegmentationSolution.send({ image: t2 })];
          case 4:
            return a2.sent(), [2, this.segmentation];
        }
      });
    });
  }, t.prototype.dispose = function() {
    this.selfieSegmentationSolution.close();
  }, t.prototype.reset = function() {
    this.selfieSegmentationSolution.reset(), this.segmentation = null, this.selfieMode = false;
  }, t.prototype.initialize = function() {
    return this.selfieSegmentationSolution.initialize();
  }, t;
}();
function se(t) {
  return D(this, void 0, void 0, function() {
    var e, n;
    return B(this, function(r2) {
      switch (r2.label) {
        case 0:
          return e = function(t2) {
            if (null == t2) return C({}, re);
            var e2 = C({}, t2);
            return e2.runtime = "mediapipe", null == e2.modelType && (e2.modelType = re.modelType), e2;
          }(t), [4, (n = new ae(e)).initialize()];
        case 1:
          return r2.sent(), [2, n];
      }
    });
  });
}
function ue(t, e, n, r2) {
  var i2 = t.width, o2 = t.height, a2 = r2 ? -1 : 1, s2 = Math.cos(t.rotation), u2 = Math.sin(t.rotation), f2 = t.xCenter, l2 = t.yCenter, c2 = 1 / e, d2 = 1 / n, h2 = new Array(16);
  return h2[0] = i2 * s2 * a2 * c2, h2[1] = -o2 * u2 * c2, h2[2] = 0, h2[3] = (-0.5 * i2 * s2 * a2 + 0.5 * o2 * u2 + f2) * c2, h2[4] = i2 * u2 * a2 * d2, h2[5] = o2 * s2 * d2, h2[6] = 0, h2[7] = (-0.5 * o2 * s2 - 0.5 * i2 * u2 * a2 + l2) * d2, h2[8] = 0, h2[9] = 0, h2[10] = i2 * c2, h2[11] = 0, h2[12] = 0, h2[13] = 0, h2[14] = 0, h2[15] = 1, function(t2) {
    if (16 !== t2.length) throw new Error("Array length must be 16 but got " + t2.length);
    return [[t2[0], t2[1], t2[2], t2[3]], [t2[4], t2[5], t2[6], t2[7]], [t2[8], t2[9], t2[10], t2[11]], [t2[12], t2[13], t2[14], t2[15]]];
  }(h2);
}
function fe(t) {
  return t instanceof Tensor ? { height: t.shape[0], width: t.shape[1] } : { height: t.height, width: t.width };
}
function le(t, e) {
  util_exports.assert(0 !== t.width, function() {
    return e + " width cannot be 0.";
  }), util_exports.assert(0 !== t.height, function() {
    return e + " height cannot be 0.";
  });
}
function ce(t, e) {
  var n = function(t2, e2, n2, r2) {
    var i2 = e2 - t2, o2 = r2 - n2;
    if (0 === i2) throw new Error("Original min and max are both " + t2 + ", range cannot be 0.");
    var a2 = o2 / i2;
    return { scale: a2, offset: n2 - t2 * a2 };
  }(0, 255, e[0], e[1]);
  return tidy(function() {
    return add(mul(t, n.scale), n.offset);
  });
}
function de(t, o2, a2) {
  var s2 = o2.outputTensorSize, f2 = o2.keepAspectRatio, l2 = o2.borderMode, c2 = o2.outputTensorFloatRange, d2 = fe(t), h2 = function(t2, e) {
    return e ? { xCenter: e.xCenter * t2.width, yCenter: e.yCenter * t2.height, width: e.width * t2.width, height: e.height * t2.height, rotation: e.rotation } : { xCenter: 0.5 * t2.width, yCenter: 0.5 * t2.height, width: t2.width, height: t2.height, rotation: 0 };
  }(d2, a2), p2 = function(t2, e, n) {
    if (void 0 === n && (n = false), !n) return { top: 0, left: 0, right: 0, bottom: 0 };
    var r2 = e.height, i2 = e.width;
    le(e, "targetSize"), le(t2, "roi");
    var o3, a3, s3 = r2 / i2, u2 = t2.height / t2.width, f3 = 0, l3 = 0;
    return s3 > u2 ? (o3 = t2.width, a3 = t2.width * s3, l3 = (1 - u2 / s3) / 2) : (o3 = t2.height / s3, a3 = t2.height, f3 = (1 - s3 / u2) / 2), t2.width = o3, t2.height = a3, { top: l3, left: f3, right: f3, bottom: l3 };
  }(h2, s2, f2), m2 = ue(h2, d2.width, d2.height, false), g2 = tidy(function() {
    var r2, o3 = (r2 = t) instanceof Tensor ? r2 : browser_exports.fromPixels(r2), a3 = tensor2d(function(t2, e, n) {
      return le(n, "inputResolution"), [1 / n.width * t2[0][0] * e.width, 1 / n.height * t2[0][1] * e.width, t2[0][3] * e.width, 1 / n.width * t2[1][0] * e.height, 1 / n.height * t2[1][1] * e.height, t2[1][3] * e.height, 0, 0];
    }(m2, d2, s2), [1, 8]), f3 = "zero" === l2 ? "constant" : "nearest", h3 = image.transform(expandDims(cast(o3, "float32")), a3, "bilinear", f3, 0, [s2.height, s2.width]);
    return null != c2 ? ce(h3, c2) : h3;
  });
  return { imageTensor: g2, padding: p2, transformationMatrix: m2 };
}
function he(t, e, n) {
  return tidy(function() {
    var r2 = squeeze(t, [0]), i2 = r2.shape[2];
    if (1 === i2) {
      var o2 = r2;
      switch (e.activation) {
        case "none":
          break;
        case "sigmoid":
          o2 = sigmoid(o2);
          break;
        case "softmax":
          throw new Error("Softmax activation requires two channels.");
        default:
          throw new Error("Activation not supported (" + e.activation + ")");
      }
      var a2 = n ? image.resizeBilinear(o2, [n.height, n.width]) : o2;
      return squeeze(a2, [2]);
    }
    throw new Error("Unsupported number of tensor channels " + i2);
  });
}
var pe = { runtime: "tfjs", modelType: "general", modelUrl: "https://tfhub.dev/mediapipe/tfjs-model/selfie_segmentation/general/1" };
var me = { flipHorizontal: false };
var ge = { outputTensorSize: { width: 256, height: 256 }, keepAspectRatio: false, borderMode: "zero", outputTensorFloatRange: [0, 1] };
var ve = { outputTensorSize: { width: 256, height: 144 }, keepAspectRatio: false, borderMode: "zero", outputTensorFloatRange: [0, 1] };
var we = { activation: "none" };
var ye = function() {
  function t(t2) {
    this.mask = t2;
  }
  return t.prototype.toCanvasImageSource = function() {
    return D(this, void 0, void 0, function() {
      return B(this, function(t2) {
        return [2, z(this.mask)];
      });
    });
  }, t.prototype.toImageData = function() {
    return D(this, void 0, void 0, function() {
      return B(this, function(t2) {
        return [2, W(this.mask)];
      });
    });
  }, t.prototype.toTensor = function() {
    return D(this, void 0, void 0, function() {
      return B(this, function(t2) {
        return [2, this.mask];
      });
    });
  }, t.prototype.getUnderlyingType = function() {
    return "tensor";
  }, t;
}();
function be(t) {
  return V(t), "person";
}
var Se;
var xe = function() {
  function t(t2, e) {
    this.modelType = t2, this.model = e;
  }
  return t.prototype.segmentPeople = function(t2, e) {
    return D(this, void 0, void 0, function() {
      var n, i2 = this;
      return B(this, function(o2) {
        return e = function(t3) {
          if (null == t3) return C({}, me);
          var e2 = C({}, t3);
          return null == e2.flipHorizontal && (e2.flipHorizontal = me.flipHorizontal), e2;
        }(e), null == t2 ? (this.reset(), [2, []]) : (n = tidy(function() {
          var e2 = de(t2, "general" === i2.modelType ? ge : ve).imageTensor, n2 = slice(i2.model.predict(e2), [0, 0, 0, 1], -1), r2 = fe(t2), o3 = he(n2, we, r2), a2 = expandDims(o3, 2), s2 = pad(a2, [[0, 0], [0, 0], [0, 1]]);
          return mirrorPad(s2, [[0, 0], [0, 0], [0, 2]], "symmetric");
        }), [2, [{ maskValueToLabel: be, mask: new ye(n) }]]);
      });
    });
  }, t.prototype.dispose = function() {
    this.model.dispose();
  }, t.prototype.reset = function() {
  }, t;
}();
function Me(t) {
  return D(this, void 0, void 0, function() {
    var e, n, r2;
    return B(this, function(i2) {
      switch (i2.label) {
        case 0:
          return e = function(t2) {
            if (null == t2) return C({}, pe);
            var e2 = C({}, t2);
            if (e2.runtime = "tfjs", null == e2.modelType && (e2.modelType = pe.modelType), "general" !== e2.modelType && "landscape" !== e2.modelType) throw new Error("Model type must be one of general or landscape, but got " + e2.modelType);
            null == e2.modelUrl && ("general" === e2.modelType ? e2.modelUrl = "https://tfhub.dev/mediapipe/tfjs-model/selfie_segmentation/general/1" : e2.modelUrl = "https://tfhub.dev/mediapipe/tfjs-model/selfie_segmentation/landscape/1");
            return e2;
          }(t), n = "string" == typeof e.modelUrl && e.modelUrl.indexOf("https://tfhub.dev") > -1, [4, loadGraphModel(e.modelUrl, { fromTFHub: n })];
        case 1:
          return r2 = i2.sent(), [2, new xe(e.modelType, r2)];
      }
    });
  });
}
function ke(t, e) {
  return D(this, void 0, void 0, function() {
    var n, r2;
    return B(this, function(i2) {
      switch (t) {
        case Se.MediaPipeSelfieSegmentation:
          if (n = void 0, null != (r2 = e)) {
            if ("tfjs" === r2.runtime) return [2, Me(r2)];
            if ("mediapipe" === r2.runtime) return [2, se(r2)];
            n = r2.runtime;
          }
          throw new Error("Expect modelConfig.runtime to be either 'tfjs' or 'mediapipe', but got " + n);
        case Se.BodyPix:
          return [2, ne(r2 = e)];
        default:
          throw new Error(t + " is not a supported model name.");
      }
    });
  });
}
!function(t) {
  t.BodyPix = "BodyPix", t.MediaPipeSelfieSegmentation = "MediaPipeSelfieSegmentation";
}(Se || (Se = {}));

// node_modules/@tensorflow-models/depth-estimation/dist/depth-estimation.esm.js
var r = function() {
  return r = Object.assign || function(t) {
    for (var e, n = 1, r2 = arguments.length; n < r2; n++) for (var o2 in e = arguments[n]) Object.prototype.hasOwnProperty.call(e, o2) && (t[o2] = e[o2]);
    return t;
  }, r.apply(this, arguments);
};
function o(t, e, n, r2) {
  return new (n || (n = Promise))(function(o2, i2) {
    function a2(t2) {
      try {
        u2(r2.next(t2));
      } catch (t3) {
        i2(t3);
      }
    }
    function s2(t2) {
      try {
        u2(r2.throw(t2));
      } catch (t3) {
        i2(t3);
      }
    }
    function u2(t2) {
      var e2;
      t2.done ? o2(t2.value) : (e2 = t2.value, e2 instanceof n ? e2 : new n(function(t3) {
        t3(e2);
      })).then(a2, s2);
    }
    u2((r2 = r2.apply(t, e || [])).next());
  });
}
function i(t, e) {
  var n, r2, o2, i2, a2 = { label: 0, sent: function() {
    if (1 & o2[0]) throw o2[1];
    return o2[1];
  }, trys: [], ops: [] };
  return i2 = { next: s2(0), throw: s2(1), return: s2(2) }, "function" == typeof Symbol && (i2[Symbol.iterator] = function() {
    return this;
  }), i2;
  function s2(i3) {
    return function(s3) {
      return function(i4) {
        if (n) throw new TypeError("Generator is already executing.");
        for (; a2; ) try {
          if (n = 1, r2 && (o2 = 2 & i4[0] ? r2.return : i4[0] ? r2.throw || ((o2 = r2.return) && o2.call(r2), 0) : r2.next) && !(o2 = o2.call(r2, i4[1])).done) return o2;
          switch (r2 = 0, o2 && (i4 = [2 & i4[0], o2.value]), i4[0]) {
            case 0:
            case 1:
              o2 = i4;
              break;
            case 4:
              return a2.label++, { value: i4[1], done: false };
            case 5:
              a2.label++, r2 = i4[1], i4 = [0];
              continue;
            case 7:
              i4 = a2.ops.pop(), a2.trys.pop();
              continue;
            default:
              if (!(o2 = a2.trys, (o2 = o2.length > 0 && o2[o2.length - 1]) || 6 !== i4[0] && 2 !== i4[0])) {
                a2 = 0;
                continue;
              }
              if (3 === i4[0] && (!o2 || i4[1] > o2[0] && i4[1] < o2[3])) {
                a2.label = i4[1];
                break;
              }
              if (6 === i4[0] && a2.label < o2[1]) {
                a2.label = o2[1], o2 = i4;
                break;
              }
              if (o2 && a2.label < o2[2]) {
                a2.label = o2[2], a2.ops.push(i4);
                break;
              }
              o2[2] && a2.ops.pop(), a2.trys.pop();
              continue;
          }
          i4 = e.call(t, a2);
        } catch (t2) {
          i4 = [6, t2], r2 = 0;
        } finally {
          n = o2 = 0;
        }
        if (5 & i4[0]) throw i4[1];
        return { value: i4[0] ? i4[1] : void 0, done: true };
      }([i3, s3]);
    };
  }
}
function a(t, e, n, r2) {
  var o2 = e - t, i2 = r2 - n;
  if (0 === o2) throw new Error("Original min and max are both " + t + ", range cannot be 0.");
  var a2 = i2 / o2;
  return { scale: a2, offset: n - t * a2 };
}
function s(t) {
  return t instanceof SVGAnimatedLength ? t.baseVal.value : t;
}
function u(t) {
  return o(this, void 0, void 0, function() {
    var e, r2;
    return i(this, function(o2) {
      switch (o2.label) {
        case 0:
          return e = document.createElement("canvas"), t instanceof Tensor ? [4, browser_exports.toPixels(t, e)] : [3, 2];
        case 1:
          return o2.sent(), [3, 3];
        case 2:
          e.width = s(t.width), e.height = s(t.height), r2 = e.getContext("2d"), t instanceof ImageData ? r2.putImageData(t, 0, 0) : r2.drawImage(t, 0, 0), o2.label = 3;
        case 3:
          return [2, e];
      }
    });
  });
}
function l(t, e) {
  if ("webgl" === getBackend()) return function(t2, e2) {
    var r3 = { variableNames: ["image", "segmentation"], outputShape: t2.shape, userCode: "\n  void main() {\n      ivec3 coords = getOutputCoords();\n      int height = coords[0];\n      int width = coords[1];\n      int channel = coords[2];\n      float value = getImage(height, width, channel);\n      float foregroundProbability = getSegmentation(height, width, 0);\n      setOutput(foregroundProbability >= 0.5 ? value : 0.0);\n    }\n" }, o3 = backend().compileAndRun(r3, [t2, e2]);
    return engine().makeTensorFromDataId(o3.dataId, o3.shape, o3.dtype);
  }(t, e);
  var r2 = t.shape, o2 = r2[0], i2 = r2[1], a2 = r2[2], s2 = slice(e, 0, [o2, i2, 1]), u2 = round(s2), l2 = tile(u2, [1, 1, a2]);
  return mul(t, l2);
}
var c = { depthModelUrl: "https://tfhub.dev/tensorflow/tfjs-model/ar_portrait_depth/1" };
var f = false;
var h;
var d = function() {
  function t(t2) {
    this.depthTensor = t2;
  }
  return t.prototype.toCanvasImageSource = function() {
    return o(this, void 0, void 0, function() {
      return i(this, function(t2) {
        return [2, u(this.depthTensor)];
      });
    });
  }, t.prototype.toArray = function() {
    return o(this, void 0, void 0, function() {
      return i(this, function(t2) {
        return [2, this.depthTensor.arraySync()];
      });
    });
  }, t.prototype.toTensor = function() {
    return o(this, void 0, void 0, function() {
      return i(this, function(t2) {
        return [2, this.depthTensor];
      });
    });
  }, t.prototype.getUnderlyingType = function() {
    return "tensor";
  }, t;
}();
var p = a(0, 255, 0, 1);
var m = function() {
  function t(t2, e) {
    this.segmenter = t2, this.estimatorModel = e;
  }
  return t.prototype.estimateDepth = function(t2, e) {
    return o(this, void 0, void 0, function() {
      var o2, s2, u2, c2, h2, m2, v2, g2, b = this;
      return i(this, function(i2) {
        switch (i2.label) {
          case 0:
            return o2 = function(t3) {
              if (null == t3 || null == t3.minDepth || null == t3.maxDepth) throw new Error("An estimation config with minDepth and maxDepth set must be provided.");
              if (t3.minDepth > t3.maxDepth) throw new Error("minDepth must be <= maxDepth.");
              var e2 = r({}, t3);
              return null == e2.flipHorizontal && (e2.flipHorizontal = f), e2;
            }(e), null == t2 ? (this.reset(), [2, null]) : (s2 = tidy(function() {
              var e2, r2 = cast((e2 = t2) instanceof Tensor ? e2 : browser_exports.fromPixels(e2), "float32");
              if (o2.flipHorizontal) {
                r2 = squeeze(image.flipLeftRight(expandDims(r2, 0)), [0]);
              }
              return r2;
            }), u2 = s2.shape, c2 = u2[0], h2 = u2[1], [4, this.segmenter.segmentPeople(s2)]);
          case 1:
            return m2 = i2.sent(), [4, m2[0].mask.toTensor()];
          case 2:
            return v2 = i2.sent(), g2 = tidy(function() {
              var t3 = l(s2, v2);
              v2.dispose();
              var e2 = add(mul(t3, p.scale), p.offset), r2 = image.resizeBilinear(e2, [256, 192]), i3 = expandDims(r2), u3 = b.estimatorModel.predict(i3), f2 = a(o2.minDepth, o2.maxDepth, 0, 1), d2 = f2.scale / 2, m3 = add(mul(u3, d2), f2.offset), g3 = clipByValue(m3, 0, 1), w = image.resizeBilinear(g3, [c2, h2]);
              return squeeze(w, [0, 3]);
            }), s2.dispose(), [2, new d(g2)];
        }
      });
    });
  }, t.prototype.dispose = function() {
    this.segmenter.dispose(), this.estimatorModel.dispose();
  }, t.prototype.reset = function() {
    this.segmenter.reset();
  }, t;
}();
function v(n) {
  return o(this, void 0, void 0, function() {
    var o2, a2, s2, u2;
    return i(this, function(i2) {
      switch (i2.label) {
        case 0:
          return o2 = function(t) {
            if (null == t) return r({}, c);
            var e = r({}, t);
            return null == e.depthModelUrl && (e.depthModelUrl = c.depthModelUrl), e;
          }(n), a2 = "string" == typeof o2.depthModelUrl && o2.depthModelUrl.indexOf("https://tfhub.dev") > -1, [4, loadGraphModel(o2.depthModelUrl, { fromTFHub: a2 })];
        case 1:
          return s2 = i2.sent(), [4, ke(Se.MediaPipeSelfieSegmentation, { runtime: "tfjs", modelUrl: o2.segmentationModelUrl })];
        case 2:
          return u2 = i2.sent(), [2, new m(u2, s2)];
      }
    });
  });
}
function g(t, e) {
  return o(this, void 0, void 0, function() {
    return i(this, function(n) {
      if (t === h.ARPortraitDepth) return [2, v(e)];
      throw new Error(t + " is not a supported model name.");
    });
  });
}
!function(t) {
  t.ARPortraitDepth = "ARPortraitDepth";
}(h || (h = {}));
export {
  h as SupportedModels,
  g as createEstimator
};
/*! Bundled license information:

@tensorflow-models/body-segmentation/dist/body-segmentation.esm.js:
  (**
      * @license
      * Copyright 2023 Google LLC. All Rights Reserved.
      * Licensed under the Apache License, Version 2.0 (the "License");
      * you may not use this file except in compliance with the License.
      * You may obtain a copy of the License at
      *
      * http://www.apache.org/licenses/LICENSE-2.0
      *
      * Unless required by applicable law or agreed to in writing, software
      * distributed under the License is distributed on an "AS IS" BASIS,
      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      * See the License for the specific language governing permissions and
      * limitations under the License.
      * =============================================================================
      *)

@tensorflow-models/depth-estimation/dist/depth-estimation.esm.js:
  (**
      * @license
      * Copyright 2023 Google LLC. All Rights Reserved.
      * Licensed under the Apache License, Version 2.0 (the "License");
      * you may not use this file except in compliance with the License.
      * You may obtain a copy of the License at
      *
      * http://www.apache.org/licenses/LICENSE-2.0
      *
      * Unless required by applicable law or agreed to in writing, software
      * distributed under the License is distributed on an "AS IS" BASIS,
      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      * See the License for the specific language governing permissions and
      * limitations under the License.
      * =============================================================================
      *)
*/
//# sourceMappingURL=@tensorflow-models_depth-estimation.js.map
